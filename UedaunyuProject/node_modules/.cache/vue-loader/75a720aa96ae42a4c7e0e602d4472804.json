{"remainingRequest":"G:\\仕事\\TenkoSystem\\UedaunyuProject\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\仕事\\TenkoSystem\\UedaunyuProject\\src\\pages\\NyukinNyuryoku.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\仕事\\TenkoSystem\\UedaunyuProject\\src\\pages\\NyukinNyuryoku.vue","mtime":1603716298000},{"path":"G:\\仕事\\TenkoSystem\\UedaunyuProject\\node_modules\\babel-loader\\lib\\index.js","mtime":1603716210000},{"path":"G:\\仕事\\TenkoSystem\\UedaunyuProject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1603716214000},{"path":"G:\\仕事\\TenkoSystem\\UedaunyuProject\\node_modules\\vue-loader\\lib\\index.js","mtime":1603716292000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// @ is an alias to /src\nimport KeyboardEvents from '@/components/KeyboardEvents.vue'\nimport config from '@/config.js'\nimport validation from '@/js/status/validation.js'\nimport ElIncrementSearch from '@/components/IncrementSearch.vue'\nimport time from '@/js/status/time.js'\n\n\nexport default {\n    name: 'nyukinNyuryoku',\n    components: {\n        KeyboardEvents, ElIncrementSearch\n    },\n    data: function () {\n        return {\n            data: {\n                syoriKubun: 0,\n                nyukinDate: \"\",\n                search: {\n                    nyukinDate: \"\",\n                    syouhinCode: \"\",\n                    syouhinName: \"\",\n                    bikou: \"\",\n                    result: [\n                    ],\n                    selectedIndex: null,\n                },\n                //更新ボタンの文字\n                updateButton: \"更新\",\n                disabled: {\n                    nyukinConfirm: false,\n                },\n                shijoData: [],\n                dialogVisible: false,\n                receptionNumber: \"\",\n                nyukinModel: {\n                    meisai: [],\n                    uriage: [],\n                    nyukinDate: \"\",\n                    shijoCode: \"\",\n                    shijoName:\"\",\n                    bikou: \"\",\n                },\n\n            },\n        }\n    },\n    methods: {\n        keyboardEvent(e) {\n            if (e.keyCode == config.KEY_CODES.F4) {\n\n                if (!this.data.disabled.nyukinConfirm && this.data.syoriKubun != 0) {\n                    this.data.dialogVisible = true;\n                }\n\n            }\n\n            if (e.keyCode == config.KEY_CODES.F9) {\n\n                this.update()\n\n            }\n            if (e.keyCode == config.KEY_CODES.F10) {\n                this.init()\n            }\n            if (e.keyCode == config.KEY_CODES.F12) {\n                this.finish()\n            }\n        },\n        createMeisaiData: function (nyukinkubunCode, nyukinkubunName, kingaku, bikou, row) {\n\n            return {\n                nyukinkubunCode: nyukinkubunCode,\n                nyukinkubunName: nyukinkubunName,\n                kingaku: kingaku,\n                bikou: bikou,\n                row: row,\n            };\n\n        },\n        addMeisai: function (nyukinkubunCode, nyukinkubunName, kingaku, bikou, row) {\n\n            var data = this.createMeisaiData(nyukinkubunCode, nyukinkubunName, kingaku, bikou, row);\n\n            this.data.nyukinModel.meisai.push(data);\n\n\n        },\n        createUriageData: function (keshikomiFlag, reception_number, syukkaDate, kingaku, row) {\n\n            return {\n                keshikomiFlag: keshikomiFlag,\n                reception_number: reception_number,\n                syukkaDate: syukkaDate,\n                kingaku: kingaku,\n                row: row,\n            };\n\n        },\n        addUriage: function (keshikomiFlag, reception_number, syukkaDate, kingaku, row) {\n\n            var data = this.createUriageData(keshikomiFlag, reception_number, syukkaDate, kingaku, row);\n\n            this.data.nyukinModel.uriage.push(data);\n\n\n        },\n        createSearchResultData: function (reception_number, date, shijo, kingaku, bikou) {\n\n            return {\n                reception_number: reception_number,\n                date: date,\n                shijo: shijo,\n                kingaku: kingaku,\n                bikou: bikou,\n            };\n\n        },\n        addSearchResult: function (reception_number, date, shijo, kingaku, bikou) {\n\n            var data = this.createSearchResultData(reception_number, date, shijo, kingaku, bikou);\n\n            this.data.search.result(data);\n\n\n        },\n        nyukinConfirm: function () {\n\n\n            this.$refs['nyukinForm'].validate((valid) => {\n                if (valid) {\n\n\n\n                    var select_value = this.data.syoriKubun;\n\n                    if (select_value == 0) {\n                        //新規の時\n\n\n                        //更新ボタンの中身編集\n                        this.data.updateButton = \"新規\"\n\n                        this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\n\n                        //※axiosから取ってくる\n                        this.addUriage(false, \"10000\", \"2020-08-10\", 0, this.data.nyukinModel.uriage.length);\n\n\n                    } else {\n\n                        if (this.data.receptionNumber == \"\") {\n                            alert(\"受付番号を検索してください\");\n                            return false;\n                        }\n\n\n\n                        //※ここでaxiosで荷受け番号をもとにT荷受けからデータを取ってくる\n\n                        //検索で選択したデータを明細に追加する。とりあえずは適当なデータを明細に入れるので、後にdbから取ってくる\n                        //明細の行を初期化\n                        this.data.nyukinModel.meisai = [];\n                        this.data.nyukinModel.uriage = [];\n\n                        for (var i = 0; i < 4; i++) {\n                            var sample_meisai = this.createMeisaiData(\"\", \"\", i * 100, \"\", this.data.nyukinModel.meisai.length);\n\n                            this.data.nyukinModel.meisai.push(sample_meisai);\n\n                            //※axiosから取ってくる\n                            this.addUriage(false, \"10000\", \"2020-08-10\", i * 100, this.data.nyukinModel.uriage.length);\n                        }\n\n                        this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\n\n                        if (select_value == 2) {\n                            //更新ボタンの中身編集\n                            this.data.updateButton = \"削除\"\n\n                        }\n                    }\n\n                    this.data.disabled.nyukinConfirm = true;\n\n                    console.log(this.data.nyukinModel.uriage);\n\n\n\n\n                } else {\n                    return false;\n                }\n            });\n\n\n\n        },\n        meisaiRemove: function (index) {\n\n            if (this.data.nyukinModel.meisai.length > 1) {\n\n                //明細の削除\n                this.data.nyukinModel.meisai.splice(index, 1);\n\n            }\n        },\n        meisaiReturn: function (row,index) {\n\n\n            if (this.data.syoriKubun == 0) {\n\n                var meisai = this.data.nyukinModel.meisai[index];\n\n                console.log(row, meisai);\n\n                meisai.nyukinkubunCode = \"\";\n                meisai.nyukinkubunName = \"\";\n                meisai.kingaku = \"\";\n                meisai.bikou = \"\";\n\n\n            } else if (this.data.syoriKubun == 1) {\n\n                //※処理区分が1の時axiosでとってきて戻す処理\n\n            }\n\n\n        },\n        changeMeisaiData: function (index) {\n\n            console.log(index);\n            if (index == this.data.nyukinModel.meisai.length - 1) {\n\n                this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\n            }\n\n        },\n        nyukinSearch: function () {\n\n\n            //検索を更新するときはresultを初期化\n            this.data.search.result = [];\n\n\n            //※ここでaxiosで検索データを取ってくる\n            //とりあえずのデータ、サーバーとつないだらここはajaxx\n            var sample_data = this.createSearchResultData(\"101010\", \"2020-10-10\", 2, 1000, \"あああああ\");\n\n\n            for (var i = 0; i < 4; i++) {\n\n                this.data.search.result.push(sample_data);\n\n            }\n\n        },\n        getShijoName: function (code) {\n\n            var result = \"\";\n\n            //※ここでaxiosでデータを取ってくる\n            for (var i = 0; i < this.data.shijoData.length; i++) {\n\n                if (this.data.shijoData[i].shijoCD == code) {\n\n                    result = this.data.shijoData[i].shijomei;\n                }\n            }\n\n            return result;\n        },\n        //クリックした検索結果を青くする\n        searchSelectedTr: function (index) {\n\n            this.data.search.selectedIndex = index;\n        },\n        searchResultSelect(search_result) {\n\n            this.data.receptionNumber = search_result.reception_number;\n            //モーダルを閉じる\n            this.data.dialogVisible = false;\n\n\n        },\n        init: function () {\n            //初期化\n            this.data.nyukinModel.meisai = [];\n            this.data.nyukinModel.uriage = [];\n            this.data.search.result = [];\n            this.data.nyukinModel.nyukinDate = \"\";\n            this.data.nyukinModel.shijoCode = \"\";\n            this.data.nyukinModel.shijoName = \"\";\n            this.data.receptionNumber = \"\";\n            this.data.syoriKubun = 0;\n\n            this.data.disabled.nyukinConfirm = false;\n\n\n\n        },\n        update: function () {\n\n            var message;\n            if (this.data.syoriKubun == 0) {\n                message = \"登録しますか？\";\n            } else if (this.data.syoriKubun == 1) {\n                message = \"更新しますか？\";\n            } else if (this.data.syoriKubun == 2) {\n                message = \"削除しますか？\";\n            }\n\n            if (this.data.syoriKubun == 0 || this.data.syoriKubun == 1) {\n\n                this.$refs['nyukinForm'].validate((valid) => {\n                    if (valid) {\n\n                        if (window.confirm(message)) {\n                            alert(\"実行\");\n                        }\n\n                    } else {\n                        return false;\n                    }\n                });\n\n\n            } else {\n\n                if (window.confirm(message)) {\n                    alert(\"実行\");\n                }\n\n\n            }\n\n\n\n        },\n        finish: function () {\n            alert(\"終了\");\n        },\n\n    },\n    created: function () {\n\n\n        //※axiosでとってくる\n        this.data.shijoData = [\n            { shijoCD: \"0\", shijomei: \"高岡\" },\n            { shijoCD: \"1\", shijomei: \"富山\" },\n            { shijoCD: \"2\", shijomei: \"丸果\" },\n            { shijoCD: \"3\", shijomei: \"福井\" },\n        ]\n        this.data.nyukinModel.nyukinDate = time.nowJapanDateInput();\n\n    },\n    mounted: function () {\n\n\n\n    },\n    watch: {\n\n\n    }\n\n}\n",{"version":3,"sources":["NyukinNyuryoku.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2SA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;;;AAGA;AACA;;;;AAIA;;AAEA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;;;AAKA;AACA;AACA;AACA;;;;AAIA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;;AAGA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;AACA;;;AAGA;;AAEA","file":"NyukinNyuryoku.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n    <div>\r\n\r\n        <keyboard-events v-on:keydown=\"keyboardEvent\"></keyboard-events>\r\n        <el-dialog title=\"伝票検索\"\r\n                   :visible.sync=\"data.dialogVisible\"\r\n                   width=\"90%\">\r\n            <div class=\"row\">\r\n                <div class='col-md-8'>\r\n                    <label for='請求先CD' class='col-form-label px-1' style='width:100%;'>請求先CD</label>\r\n                    <el-increment-search v-model=\"data.search.syouhinCode\"\r\n                                         :display=\"[{key:'syohinmei',name:'名前'}]\"\r\n                                         :autoComplete=\"['syohinmei']\"\r\n                                         :kind=\"'市場'\"\r\n                                         :required=\"true\"\r\n                                         @update=\"(r) => data.search.syouhinName = r.syohinmei\"></el-increment-search>\r\n                    <el-input type='text'\r\n                              style='width:50%;'\r\n                              readonly\r\n                              :placeholder=\"'請求先名'\"\r\n                              v-model=\"data.search.syouhinName\"></el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"row\">\r\n                <div class='col-md-4'>\r\n                    <label for='入金日付' class='col-form-label px-1' style='width:100%;'>入金日付</label>\r\n                    <el-input type='date'\r\n                              style='margin-right:2%;'\r\n                              :max=\"data.search.dateEnd\"\r\n                              v-model='data.search.nyukinDate'></el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"row\">\r\n                <div class='col-md-12'>\r\n                    <label for='備考' class='col-form-label px-1' style='width:100%;'>備考</label>\r\n                    <el-input type=\"textarea\"\r\n                              :rows=\"2\"\r\n                              v-model=\"data.bikou\">\r\n                    </el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"row\" style=\"margin-top:2%;\">\r\n                <div class=\"col-12\" style=\"text-align:right;\">\r\n                    <el-button @click=\"data.dialogVisible = false\">終了</el-button>\r\n                    <el-button type=\"primary\" v-on:click=\"nyukinSearch\">検索</el-button>\r\n                </div>\r\n            </div>\r\n            <el-card style=\"margin-top:1%;\">\r\n                <div slot='header'>\r\n                    <span>検索結果</span>\r\n                </div>\r\n                <div slot='default' class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <table class=\"table\">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th width=\"4%\"></th>\r\n                                    <th>入金番号</th>\r\n                                    <th>入金日</th>\r\n                                    <th>顧客名</th>\r\n                                    <th>金額</th>\r\n                                    <th>備考</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(search_result, index) in data.search.result\" v-bind:key=\"search_result.number\" v-bind:class=\"data.search.selectedIndex == index && 'search-selected'\" v-on:click=\"searchSelectedTr(index)\">\r\n                                    <td><el-button type=\"success\" name=\"name\" v-on:click=\"searchResultSelect(search_result)\">選択</el-button></td>\r\n                                    <td>{{search_result.reception_number}}</td>\r\n                                    <td>{{search_result.date}}</td>\r\n                                    <td>{{getShijoName(search_result.shijo)}}</td>\r\n                                    <td>{{search_result.kingaku}}</td>\r\n                                    <td>{{search_result.bikou}}</td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </el-card>\r\n        </el-dialog>\r\n        <el-card>\r\n            <div slot='header'>\r\n                <span>入金入力</span>\r\n            </div>\r\n            <div slot='default'>\r\n                <el-form :model=\"data.nyukinModel\" ref=\"nyukinForm\" label-width=\"120px\">\r\n                    <div class='row'>\r\n                        <div class='col-md-12'>\r\n\r\n                            <el-card>\r\n                                <template slot='default'>\r\n                                    <div class='row'>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='処理区分' class='col-form-label px-1' style='width:100%;'>処理区分</label>\r\n                                            <el-select v-model=\"data.syoriKubun\" style=\"width: 100%;\" :disabled=\"data.disabled.nyukinConfirm\">\r\n                                                <el-option :value='0' :label=\"'0:新規'\"></el-option>\r\n                                                <el-option :value='1' :label=\"'1:修正'\"></el-option>\r\n                                                <el-option :value='2' :label=\"'2:削除'\"></el-option>\r\n                                            </el-select>\r\n                                        </div>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='伝票番号' class='col-form-label px-1' style='width:100%;'>伝票番号</label>\r\n                                            <el-input id=\"receptionNumber\"\r\n                                                      type='text'\r\n                                                      style='width:60%; margin-right:2%;'\r\n                                                      v-model=\"data.receptionNumber\"\r\n                                                      :disabled=\"data.syoriKubun == 0 || data.disabled.nyukinConfirm\"></el-input>\r\n                                            <el-button id=\"receptionNumberSearch\"\r\n                                                       type='danger'\r\n                                                       icon=\"el-icon-search\"\r\n                                                       style='width:20%;display:inline;'\r\n                                                       @click=\"data.dialogVisible = true\"\r\n                                                       :disabled=\"data.syoriKubun == 0 || data.disabled.nyukinConfirm\">検索</el-button>\r\n\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                    <div class=\"row\" style=\"margin-top:2%;\">\r\n                                        <div class=\"col-md-6\">\r\n                                            <label for='請求先CD' class='col-form-label px-1' style='width:100%;'>請求先CD</label>\r\n                                            <el-form-item label-width=\"0\"\r\n                                                          prop=\"shijoCode\"\r\n                                                          :rules=\"{\r\n                                                              required: false, message: '請求先CDが選択されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                          style=\"margin:0;\">\r\n                                                <!--※とりあえずrequired:false;-->\r\n                                                <el-increment-search v-model=\"data.nyukinModel.shijoCode\"\r\n                                                                     :display=\"[{key:'syohinmei',name:'名前'}]\"\r\n                                                                     :autoComplete=\"['syohinmei']\"\r\n                                                                     :kind=\"'市場'\"\r\n                                                                     :required=\"true\"\r\n                                                                     @update=\"(r) => data.nyukinModel.shijoName = r.shijomei\"></el-increment-search>\r\n                                                <el-input type='text'\r\n                                                          style='width:50%;'\r\n                                                          readonly\r\n                                                          :placeholder=\"'請求先名'\"\r\n                                                          v-model=\"data.nyukinModel.shijoName\"></el-input>\r\n                                            </el-form-item>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div class='row' style=\"margin-top:2%;\">\r\n                                        <div class='col-md-6'>\r\n                                            <label for='入金日付' class='col-form-label px-1'>入金日付</label>\r\n                                            <el-form-item label-width=\"0\"\r\n                                                          prop=\"nyukinDate\"\r\n                                                          :rules=\"{\r\n                                                              required: true, message: '入金日付が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                          style=\"margin:0;\">\r\n                                                <el-input id=\"nyukinDate\"\r\n                                                          type=\"date\"\r\n                                                          v-model=\"data.nyukinModel.nyukinDate\" v-bind:disabled=\"data.disabled.nyukinConfirm\"></el-input>\r\n                                            </el-form-item>\r\n                                        </div>\r\n\r\n                                    </div>\r\n\r\n                                    <div class=\"row\">\r\n                                        <div class='col-md-8' style=\"margin-top:2%;\">\r\n                                            <label for='備考' class='col-form-label px-1' style='width:100%;'>備考</label>\r\n                                            <el-input type=\"textarea\"\r\n                                                      :rows=\"4\"\r\n                                                      v-model=\"data.nyukinModel.bikou\"\r\n                                                      :disabled=\"data.disabled.nyukinConfirm\">\r\n                                            </el-input>\r\n                                        </div>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='確認' class='col-form-label px-1'>確認</label>\r\n                                            <el-button type='primary'\r\n                                                       style=\"display:block;\"\r\n                                                       :disabled=\"data.disabled.nyukinConfirm\"\r\n                                                       v-on:click=\"nyukinConfirm\">確認</el-button>\r\n                                        </div>\r\n                                    </div>\r\n                                </template>\r\n                            </el-card>\r\n                        </div>\r\n                    </div>\r\n                    <el-card style=\"margin-top:3%;\">\r\n                        <div slot='header'>\r\n                            <span>明細</span>\r\n                        </div>\r\n                        <div class=\"row\">\r\n                            <div class=\"col-8\">\r\n                                <label for='入金' class='col-form-label px-1' style='width:100%;'>入金</label>\r\n                                <table class=\"table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th width=\"4%\"></th>\r\n                                            <th>削除</th>\r\n                                            <th>入金区分</th>\r\n                                            <th>入金区分名</th>\r\n                                            <th>金額</th>\r\n                                            <th>備考</th>\r\n                                            <th>キャンセル</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <tr v-for=\"(meisai_data, index) in data.nyukinModel.meisai\" v-bind:key=\"meisai_data.number\" style=\"margin-bottom:10px;\">\r\n                                            <td>{{index}}</td>\r\n                                            <td><el-button type=\"primary\" name=\"name\" v-on:click=\"meisaiRemove(index)\" v-bind:disabled=\"data.syoriKubun == 3\">削除</el-button></td>\r\n                                            <td>\r\n                                                <el-form-item label-width=\"0\"\r\n                                                              :prop=\"'meisai[' + index + '].nyukinkubunCode'\"\r\n                                                              :rules=\"{\r\n                                                              required: true, message: '入金区分が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                              style=\"margin:0;\">\r\n                                                    <el-increment-search v-model=\"meisai_data.nyukinkubunCode\"\r\n                                                                         style='width:100%;'\r\n                                                                         :display=\"[{key:'nyukinkubunmei',name:'名前'}]\"\r\n                                                                         :autoComplete=\"['nyukinkubunmei']\"\r\n                                                                         :kind=\"'入金'\"\r\n                                                                         :required=\"true\"\r\n                                                                         :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\"\r\n                                                                         @change=\"changeMeisaiData(index)\"\r\n                                                                         @update=\"\"></el-increment-search>\r\n                                                </el-form-item>\r\n                                            </td>\r\n                                            <td>\r\n                                                <el-input type='text'\r\n                                                          style='width:100%;'\r\n                                                          readonly\r\n                                                          :placeholder=\"'入金区分名'\"\r\n                                                          :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\"\r\n                                                          @change=\"changeMeisaiData(index)\"\r\n                                                          v-model=\"meisai_data.nyukinkubunName\"></el-input>\r\n                                            </td>\r\n                                            <td>\r\n                                                <el-form-item label-width=\"0\"\r\n                                                              :prop=\"'meisai[' + index + '].kingaku'\"\r\n                                                              :rules=\"{\r\n                                                              required: true, message: '金額が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                              style=\"margin:0;\">\r\n\r\n                                                    <el-input-number name=\"name\" v-model=\"meisai_data.kingaku\" :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\" @change=\"changeMeisaiData(index)\"></el-input-number>\r\n                                                </el-form-item>\r\n                                            </td>\r\n                                            <td>\r\n                                                <el-input name=\"name\" v-model=\"meisai_data.bikou\" :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\" @change=\"changeMeisaiData(index)\"></el-input>\r\n                                            </td>\r\n\r\n                                            <td><el-button type=\"warning\" name=\"name\" v-on:click=\"meisaiReturn(meisai_data.row,index)\" :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\">キャンセル</el-button></td>\r\n                                        </tr>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                            <div class=\"col-4\">\r\n                                <label for='売上' class='col-form-label px-1' style='width:100%;'>売上</label>\r\n                                <table class=\"table\">\r\n                                    <thead>\r\n                                        <tr>\r\n                                            <th width=\"4%\"></th>\r\n                                            <th>削除</th>\r\n                                            <th>消込F</th>\r\n                                            <th>伝票番号</th>\r\n                                            <th>出荷日付</th>\r\n                                            <th>金額</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        <tr v-for=\"(meisai_data, index) in data.nyukinModel.uriage\" v-bind:key=\"meisai_data.number\" style=\"margin-bottom:10px;\">\r\n                                            <td>{{index}}</td>\r\n                                            <td><el-button type=\"primary\" name=\"name\" v-on:click=\"meisaiRemove(index)\" v-bind:disabled=\"data.syoriKubun == 3\">削除</el-button></td>\r\n                                            <td>\r\n                                                <el-checkbox v-model=\"meisai_data.keshikomiFlag\" :disabled=\"data.syoriKubun == 2 || data.syoriKubun == 3\"></el-checkbox>\r\n                                            </td>\r\n                                            <td>\r\n                                                {{meisai_data.reception_number}}\r\n                                            </td>\r\n                                            <td>\r\n                                                {{meisai_data.syukkaDate}}\r\n                                            </td>\r\n                                            <td>\r\n                                                {{meisai_data.kingaku}}\r\n                                            </td>\r\n                                        </tr>\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n\r\n                            <div style='text-align:right;width:100%;'>\r\n                                <el-button id=\"updateButton\" type='success' v-bind:disabled=\"!data.disabled.nyukinConfirm || data.syoriKubun == 3\" v-on:click=\"update\">{{data.updateButton}}(F9)</el-button>\r\n                                <el-button style='margin-left:2%;' type='warning' v-on:click=\"init\">画面クリア(F10)</el-button>\r\n                                <el-button style='margin-left:2%;' type='primary' v-on:click=\"finish\">終了(F12)</el-button>\r\n                            </div>\r\n                        </div>\r\n                    </el-card>\r\n                </el-form>\r\n            </div>\r\n        </el-card>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    // @ is an alias to /src\r\n    import KeyboardEvents from '@/components/KeyboardEvents.vue'\r\n    import config from '@/config.js'\r\n    import validation from '@/js/status/validation.js'\r\n    import ElIncrementSearch from '@/components/IncrementSearch.vue'\r\n    import time from '@/js/status/time.js'\r\n\r\n\r\n    export default {\r\n        name: 'nyukinNyuryoku',\r\n        components: {\r\n            KeyboardEvents, ElIncrementSearch\r\n        },\r\n        data: function () {\r\n            return {\r\n                data: {\r\n                    syoriKubun: 0,\r\n                    nyukinDate: \"\",\r\n                    search: {\r\n                        nyukinDate: \"\",\r\n                        syouhinCode: \"\",\r\n                        syouhinName: \"\",\r\n                        bikou: \"\",\r\n                        result: [\r\n                        ],\r\n                        selectedIndex: null,\r\n                    },\r\n                    //更新ボタンの文字\r\n                    updateButton: \"更新\",\r\n                    disabled: {\r\n                        nyukinConfirm: false,\r\n                    },\r\n                    shijoData: [],\r\n                    dialogVisible: false,\r\n                    receptionNumber: \"\",\r\n                    nyukinModel: {\r\n                        meisai: [],\r\n                        uriage: [],\r\n                        nyukinDate: \"\",\r\n                        shijoCode: \"\",\r\n                        shijoName:\"\",\r\n                        bikou: \"\",\r\n                    },\r\n\r\n                },\r\n            }\r\n        },\r\n        methods: {\r\n            keyboardEvent(e) {\r\n                if (e.keyCode == config.KEY_CODES.F4) {\r\n\r\n                    if (!this.data.disabled.nyukinConfirm && this.data.syoriKubun != 0) {\r\n                        this.data.dialogVisible = true;\r\n                    }\r\n\r\n                }\r\n\r\n                if (e.keyCode == config.KEY_CODES.F9) {\r\n\r\n                    this.update()\r\n\r\n                }\r\n                if (e.keyCode == config.KEY_CODES.F10) {\r\n                    this.init()\r\n                }\r\n                if (e.keyCode == config.KEY_CODES.F12) {\r\n                    this.finish()\r\n                }\r\n            },\r\n            createMeisaiData: function (nyukinkubunCode, nyukinkubunName, kingaku, bikou, row) {\r\n\r\n                return {\r\n                    nyukinkubunCode: nyukinkubunCode,\r\n                    nyukinkubunName: nyukinkubunName,\r\n                    kingaku: kingaku,\r\n                    bikou: bikou,\r\n                    row: row,\r\n                };\r\n\r\n            },\r\n            addMeisai: function (nyukinkubunCode, nyukinkubunName, kingaku, bikou, row) {\r\n\r\n                var data = this.createMeisaiData(nyukinkubunCode, nyukinkubunName, kingaku, bikou, row);\r\n\r\n                this.data.nyukinModel.meisai.push(data);\r\n\r\n\r\n            },\r\n            createUriageData: function (keshikomiFlag, reception_number, syukkaDate, kingaku, row) {\r\n\r\n                return {\r\n                    keshikomiFlag: keshikomiFlag,\r\n                    reception_number: reception_number,\r\n                    syukkaDate: syukkaDate,\r\n                    kingaku: kingaku,\r\n                    row: row,\r\n                };\r\n\r\n            },\r\n            addUriage: function (keshikomiFlag, reception_number, syukkaDate, kingaku, row) {\r\n\r\n                var data = this.createUriageData(keshikomiFlag, reception_number, syukkaDate, kingaku, row);\r\n\r\n                this.data.nyukinModel.uriage.push(data);\r\n\r\n\r\n            },\r\n            createSearchResultData: function (reception_number, date, shijo, kingaku, bikou) {\r\n\r\n                return {\r\n                    reception_number: reception_number,\r\n                    date: date,\r\n                    shijo: shijo,\r\n                    kingaku: kingaku,\r\n                    bikou: bikou,\r\n                };\r\n\r\n            },\r\n            addSearchResult: function (reception_number, date, shijo, kingaku, bikou) {\r\n\r\n                var data = this.createSearchResultData(reception_number, date, shijo, kingaku, bikou);\r\n\r\n                this.data.search.result(data);\r\n\r\n\r\n            },\r\n            nyukinConfirm: function () {\r\n\r\n\r\n                this.$refs['nyukinForm'].validate((valid) => {\r\n                    if (valid) {\r\n\r\n\r\n\r\n                        var select_value = this.data.syoriKubun;\r\n\r\n                        if (select_value == 0) {\r\n                            //新規の時\r\n\r\n\r\n                            //更新ボタンの中身編集\r\n                            this.data.updateButton = \"新規\"\r\n\r\n                            this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\r\n\r\n                            //※axiosから取ってくる\r\n                            this.addUriage(false, \"10000\", \"2020-08-10\", 0, this.data.nyukinModel.uriage.length);\r\n\r\n\r\n                        } else {\r\n\r\n                            if (this.data.receptionNumber == \"\") {\r\n                                alert(\"受付番号を検索してください\");\r\n                                return false;\r\n                            }\r\n\r\n\r\n\r\n                            //※ここでaxiosで荷受け番号をもとにT荷受けからデータを取ってくる\r\n\r\n                            //検索で選択したデータを明細に追加する。とりあえずは適当なデータを明細に入れるので、後にdbから取ってくる\r\n                            //明細の行を初期化\r\n                            this.data.nyukinModel.meisai = [];\r\n                            this.data.nyukinModel.uriage = [];\r\n\r\n                            for (var i = 0; i < 4; i++) {\r\n                                var sample_meisai = this.createMeisaiData(\"\", \"\", i * 100, \"\", this.data.nyukinModel.meisai.length);\r\n\r\n                                this.data.nyukinModel.meisai.push(sample_meisai);\r\n\r\n                                //※axiosから取ってくる\r\n                                this.addUriage(false, \"10000\", \"2020-08-10\", i * 100, this.data.nyukinModel.uriage.length);\r\n                            }\r\n\r\n                            this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\r\n\r\n                            if (select_value == 2) {\r\n                                //更新ボタンの中身編集\r\n                                this.data.updateButton = \"削除\"\r\n\r\n                            }\r\n                        }\r\n\r\n                        this.data.disabled.nyukinConfirm = true;\r\n\r\n                        console.log(this.data.nyukinModel.uriage);\r\n\r\n\r\n\r\n\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n\r\n\r\n            },\r\n            meisaiRemove: function (index) {\r\n\r\n                if (this.data.nyukinModel.meisai.length > 1) {\r\n\r\n                    //明細の削除\r\n                    this.data.nyukinModel.meisai.splice(index, 1);\r\n\r\n                }\r\n            },\r\n            meisaiReturn: function (row,index) {\r\n\r\n\r\n                if (this.data.syoriKubun == 0) {\r\n\r\n                    var meisai = this.data.nyukinModel.meisai[index];\r\n\r\n                    console.log(row, meisai);\r\n\r\n                    meisai.nyukinkubunCode = \"\";\r\n                    meisai.nyukinkubunName = \"\";\r\n                    meisai.kingaku = \"\";\r\n                    meisai.bikou = \"\";\r\n\r\n\r\n                } else if (this.data.syoriKubun == 1) {\r\n\r\n                    //※処理区分が1の時axiosでとってきて戻す処理\r\n\r\n                }\r\n\r\n\r\n            },\r\n            changeMeisaiData: function (index) {\r\n\r\n                console.log(index);\r\n                if (index == this.data.nyukinModel.meisai.length - 1) {\r\n\r\n                    this.addMeisai(\"\", \"\", 0, \"\", this.data.nyukinModel.meisai.length);\r\n                }\r\n\r\n            },\r\n            nyukinSearch: function () {\r\n\r\n\r\n                //検索を更新するときはresultを初期化\r\n                this.data.search.result = [];\r\n\r\n\r\n                //※ここでaxiosで検索データを取ってくる\r\n                //とりあえずのデータ、サーバーとつないだらここはajaxx\r\n                var sample_data = this.createSearchResultData(\"101010\", \"2020-10-10\", 2, 1000, \"あああああ\");\r\n\r\n\r\n                for (var i = 0; i < 4; i++) {\r\n\r\n                    this.data.search.result.push(sample_data);\r\n\r\n                }\r\n\r\n            },\r\n            getShijoName: function (code) {\r\n\r\n                var result = \"\";\r\n\r\n                //※ここでaxiosでデータを取ってくる\r\n                for (var i = 0; i < this.data.shijoData.length; i++) {\r\n\r\n                    if (this.data.shijoData[i].shijoCD == code) {\r\n\r\n                        result = this.data.shijoData[i].shijomei;\r\n                    }\r\n                }\r\n\r\n                return result;\r\n            },\r\n            //クリックした検索結果を青くする\r\n            searchSelectedTr: function (index) {\r\n\r\n                this.data.search.selectedIndex = index;\r\n            },\r\n            searchResultSelect(search_result) {\r\n\r\n                this.data.receptionNumber = search_result.reception_number;\r\n                //モーダルを閉じる\r\n                this.data.dialogVisible = false;\r\n\r\n\r\n            },\r\n            init: function () {\r\n                //初期化\r\n                this.data.nyukinModel.meisai = [];\r\n                this.data.nyukinModel.uriage = [];\r\n                this.data.search.result = [];\r\n                this.data.nyukinModel.nyukinDate = \"\";\r\n                this.data.nyukinModel.shijoCode = \"\";\r\n                this.data.nyukinModel.shijoName = \"\";\r\n                this.data.receptionNumber = \"\";\r\n                this.data.syoriKubun = 0;\r\n\r\n                this.data.disabled.nyukinConfirm = false;\r\n\r\n\r\n\r\n            },\r\n            update: function () {\r\n\r\n                var message;\r\n                if (this.data.syoriKubun == 0) {\r\n                    message = \"登録しますか？\";\r\n                } else if (this.data.syoriKubun == 1) {\r\n                    message = \"更新しますか？\";\r\n                } else if (this.data.syoriKubun == 2) {\r\n                    message = \"削除しますか？\";\r\n                }\r\n\r\n                if (this.data.syoriKubun == 0 || this.data.syoriKubun == 1) {\r\n\r\n                    this.$refs['nyukinForm'].validate((valid) => {\r\n                        if (valid) {\r\n\r\n                            if (window.confirm(message)) {\r\n                                alert(\"実行\");\r\n                            }\r\n\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    });\r\n\r\n\r\n                } else {\r\n\r\n                    if (window.confirm(message)) {\r\n                        alert(\"実行\");\r\n                    }\r\n\r\n\r\n                }\r\n\r\n\r\n\r\n            },\r\n            finish: function () {\r\n                alert(\"終了\");\r\n            },\r\n\r\n        },\r\n        created: function () {\r\n\r\n\r\n            //※axiosでとってくる\r\n            this.data.shijoData = [\r\n                { shijoCD: \"0\", shijomei: \"高岡\" },\r\n                { shijoCD: \"1\", shijomei: \"富山\" },\r\n                { shijoCD: \"2\", shijomei: \"丸果\" },\r\n                { shijoCD: \"3\", shijomei: \"福井\" },\r\n            ]\r\n            this.data.nyukinModel.nyukinDate = time.nowJapanDateInput();\r\n\r\n        },\r\n        mounted: function () {\r\n\r\n\r\n\r\n        },\r\n        watch: {\r\n\r\n\r\n        }\r\n\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .search-selected {\r\n        background-color: blue;\r\n        color: white;\r\n    }\r\n</style>"]}]}