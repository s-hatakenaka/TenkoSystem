{"remainingRequest":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\src\\pages\\NiukeNyuryoku.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\src\\pages\\NiukeNyuryoku.vue","mtime":1603336365416},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\node_modules\\babel-loader\\lib\\index.js","mtime":1603336354165},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1603336354440},{"path":"C:\\Users\\takum\\Documents\\hokuriku_tosbac\\Uedaunyu\\Uedaunyu-Tenkosystem\\UedaunyuProject\\UedaunyuProject\\node_modules\\vue-loader\\lib\\index.js","mtime":1603336364622}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// @ is an alias to /src\nimport KeyboardEvents from '@/components/KeyboardEvents.vue'\nimport config from '@/config.js'\nimport validation from '@/js/status/validation.js'\nimport ElIncrementSearch from '@/components/IncrementSearch.vue'\nimport time from '@/js/status/time.js'\nimport url from '@/js/api_url.js'\n\nexport default {\n    name: 'niukeNyuryoku',\n    components: {\n        KeyboardEvents, ElIncrementSearch\n    },\n    data: function () {\n        return {\n            state1: \"\",\n            //methodsで使う際のnodeをmountedで登録し、取得する手間を省く\n            element: {\n                niukeDate: null,\n                syoriKubun: null,\n                receptionNumber: null,\n                receptionNumberSearch: null,\n                syouhinName: null,\n                hinsyuCode: null,\n                updateButton: null,\n            },\n            data: {\n                pageNumber: 1,\n                numberOfTerminal: null,\n                search: {\n                    dateStart: \"\",\n                    dateEnd: \"\",\n                    seisansya: {\n                        code: \"\",\n                        name: \"\",\n                    },\n                    result: [\n                    ],\n                    selectedIndex: null,\n                },\n                first: {\n                    model: {\n                        syoriKubun: 1,\n                        niukeDate: \"\",\n                        kaisu: 0,\n                        syouhinName: \"\",\n                        syouhinCode: \"\",\n                        jikayouChecked: false,\n                        niukeHyouChecked: true,\n                        niukeHyouHikaeChecked: true,\n                    },\n                    validation: {\n                        syoriKubun: [\n                            { required: true, message: '処理区分が入力されていません', trigger: 'blur' },\n                        ],\n                        niukeDate: [\n                            { required: true, message: '荷受日付が入力されていません', trigger: 'blur' },\n                        ],\n                        kaisu: [\n                            { required: true, message: '回数が入力されていません', trigger: 'blur' },\n                        ],\n                        syouhinCode: [\n                            { required: true, message: '商品コードが入力されていません', trigger: 'change' },\n                        ]\n                    }\n                },\n                second: {\n                    model: {\n                        niukeDate: \"\",\n                        seisansyaCode: \"\",\n                        seisansyaName: \"\",\n                        hinsyuCode: \"\",\n                        meisai: [],\n                    },\n                },\n                //更新ボタンの文字\n                updateButton: \"更新\",\n                disabled: {\n                    niukeConfirm: false,\n                },\n                shizaidai: 0,\n                zentokin: 0,\n                dialogVisible: false,\n                total: {\n                    number_of_box: 0,\n                    bara: 0,\n                    number: 0,\n                    kayoibako: 0,\n                },\n                //処理区分、第一画面の処理区分はfirst、第二画面はsecond\n                syoriKubun: {\n                    first: \"0\",\n                    second: \"0\"\n                },\n                syouhin: {\n                    first: {\n                        name: \"\",\n                        code: \"\",\n                    },\n                    second: {\n                        code: \"\",\n                        name: \"\",\n                        niuke_unit: \"\",\n                        //キーをサイズコードにして、サイズ毎の入数を呼び出す\n                        number_per_box: {\n                        }\n                        ,\n                    },\n\n                },\n                receptionNumber: \"\",\n                //荷受日付、フォーマットはinputのdateに格納できるstringの形で、\n                niukeDate: {\n                    first: '',\n                    second: \"\"\n                },\n                seisansya: {\n                    code: \"\",\n                    name: \"\"\n                },\n                note: {},\n                reason_of_return: {},\n                size: {\n                },\n                tokyu: {\n                },\n                hinsyu: [\n                ],\n\n            },\n        }\n    },\n    methods: {\n        keyboardEvent(e) {\n            if (e.keyCode == config.KEY_CODES.F5) {\n                if (this.data.pageNumber == 1) {\n                    this.searchCheck();\n                }\n\n            }\n\n            if (e.keyCode == config.KEY_CODES.F9) {\n\n                if (this.data.pageNumber == 2) {\n                    this.update()\n                }\n\n            }\n            if (e.keyCode == config.KEY_CODES.F10) {\n                if (this.data.pageNumber == 2) {\n                    this.init()\n                }\n            }\n            if (e.keyCode == config.KEY_CODES.F12) {\n                this.finish()\n            }\n        },\n        searchCheck: function () {\n\n            this.$refs['firstForm'].validate((valid) => {\n\n                if (valid) {\n                    this.data.pageNumber = 2;\n                }\n            });\n\n        },\n\n        createMeisaiData: function (code, size, tokyu, number_of_box, bara, number, note, reason_of_return) {\n\n            return {\n                code: code,\n                size: size,\n                tokyu: tokyu,\n                number_of_box: number_of_box,\n                bara: bara,\n                number: number,\n                note: note,\n                reason_of_return: reason_of_return\n            };\n\n        },\n        addMeisai: function (code, size, tokyu, number_of_box, bara, number, note, reason_of_return) {\n\n            var data = this.createMeisaiData(code, size, tokyu, number_of_box, bara, number, note, reason_of_return);\n\n            this.data.second.model.meisai.push(data);\n\n\n        },\n        createSearchResultData: function (date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin) {\n\n            return {\n                date: date,\n                reception_number: reception_number,\n                seisansya: seisansya,\n                syouhin: syouhin,\n                hinsyu: hinsyu,\n                frequency: frequency,\n                total: total,\n                shizai: shizai,\n                zentokin: zentokin,\n            };\n\n        },\n        addSearchResult: function (date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin) {\n\n            var data = this.createSearchResultData(date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin);\n\n            this.data.search.result.push(data);\n\n\n        },\n        niukeConfirm: function () {\n            //仕様書を見た感じ提出前にチェックする必要性が無いように感じるが、もし入力チェックがある場合はここに追加\n\n            var select_value = this.data.syoriKubun.second;\n\n            if (select_value == 0) {\n                //新規の時\n\n                //第一画面の荷受け日付を第二画面の荷受け日付に変える\n                this.data.second.model.niukeDate = this.data.first.model.niukeDate;\n\n                //第一画面の商品区分を元に商品名プロパティに入れる。そのデータを取ってくる。とりあえず定数を入れておくので変えてください。\n                this.data.syouhin.second.code = this.data.first.model.syouhinCode;\n                this.data.syouhin.second.name = this.data.first.model.syouhinName;\n\n                this.getHinsyuSelect()\n\n                //更新ボタンの中身編集\n                this.data.updateButton = \"新規\"\n\n                this.getMasterData(true);\n\n\n            } else if (select_value == 1 || select_value == 2) {\n\n                if (this.data.receptionNumber == \"\") {\n                    alert(\"受付番号を検索してください\");\n                    return false;\n                }\n\n\n\n                //※ここでaxiosで荷受け番号をもとにT荷受けからデータを取ってくる\n\n\n                axios.get(url.niukeNyuryoku + \"?reception_number=\" + this.data.receptionNumber)\n                    .then(response => {\n\n                        console.log(response.data);\n\n                        var data = response.data[0];\n\n                        if (data.meisaiData.length == 0) {\n\n                            alert(\"データがありません\");\n                            return false;\n                        }\n\n                        //検索で選択したデータを明細に追加する。とりあえずは適当なデータを明細に入れるので、後にdbから取ってくる\n                        //明細の行を初期化\n                        this.data.second.model.meisai = [];\n\n                        this.data.second.model.niukeDate = data.date;\n                        this.data.second.model.seisansyaCode = String(data.seisansyacd);\n                        this.data.second.model.seisansyaName = data.seisansya;\n                        this.data.syouhin.second.name = data.syohin;\n                        this.data.syouhin.second.code = data.syohincd;\n\n                        this.data.total.kayoibako = data.total;\n                        this.data.shizaidai = data.shizai;\n                        this.data.zentokin = data.zentokin;\n\n                        console.log(\"商品コード:\", this.data.syouhin.second.code);\n                        this.getHinsyuSelect()\n\n                        this.data.second.model.hinsyuCode = data.hinsyucd;\n\n                        console.log(this.data.second.model.hinsyuCode);\n\n                        if (select_value == 2) {\n                            //更新ボタンの中身編集\n                            this.data.updateButton = \"削除\"\n\n                        } else if (select_value == 1) {\n                            this.data.updateButton = \"編集\"\n                        }\n\n                        this.getMasterData(false, data.meisaiData);\n\n                    })\n                    .catch(response => console.log(response))\n\n            }\n\n\n\n        },\n        meisaiRemove: function (index) {\n\n            if (this.data.second.model.meisai.length > 1) {\n\n                //明細の削除\n                this.data.second.model.meisai.splice(index, 1);\n\n            }\n        },\n        //明細のコードの入力チェック\n        meisaiCodeCheck: function (meisai_data, input, index) {\n\n            var input_code = input.value;\n\n            //数値バリデーション\n            if (!validation.validation.is_intager_filling_zero(input_code)) {\n\n                alert(validation.error_message.is_intager_filling_zero(\"コード\"));\n\n                input.value = meisai_data.code;\n                return false;\n\n            }\n\n\n            if (input_code.length != 4) {\n\n                alert(\"文字数は4桁である必要があります。\");\n                input.value = meisai_data.code;\n                return false;\n            }\n\n            var size_code = input_code.substr(0, 2);\n            var tokyu_code = input_code.substr(2, 2);\n\n            var size_name = this.sizeSearch(size_code);\n            var tokyu_name = this.tokyuSearch(tokyu_code);\n\n            if (size_name == undefined) {\n\n                alert(\"サイズがありません\");\n                input.value = meisai_data.code;\n                return false;\n            }\n\n            if (tokyu_name == undefined) {\n\n                alert(\"等級がありません\");\n                input.value = meisai_data.code;\n                return false;\n            }\n\n            meisai_data.size = size_code;\n            meisai_data.tokyu = tokyu_code;\n            meisai_data.code = input.value;\n\n            this.numberChange(meisai_data);\n\n\n        },\n        sizeSearch: function (size) {\n\n\n\n            //検索して、ものがあれば名称を返し、無ければundefinedで返す\n            var result;\n\n            var is_exist = false;\n            var key;\n            for (var i in this.data.size) {\n\n                if (i == size) {\n\n                    is_exist = true;\n                    key = i;\n\n                }\n\n            }\n            if (is_exist) {\n                result = this.data.size[key];\n            }\n\n            return result\n\n        },\n        tokyuSearch: function (tokyu) {\n\n\n            //検索して、ものがあれば名称を返し、無ければundefinedで返す\n            var result;\n\n            var is_exist = false;\n            var key;\n            for (var i in this.data.tokyu) {\n\n                if (i == tokyu) {\n\n                    is_exist = true;\n                    key = i;\n                }\n\n            }\n\n            if (is_exist) {\n                result = this.data.tokyu[key];\n            }\n\n            return result;\n\n        },\n        //箱数またはバラの値を変化させた時の処理,paramは箱数かバラかのパラメーター\n        numberChange: function (meisai_data) {\n\n\n            if (this.data.syouhin.second.niuke_unit == 0) {\n\n                if (meisai_data.number_of_box == undefined || meisai_data.size == null || meisai_data.bara == undefined) {\n\n                    meisai_data.number = 0;\n\n                    return false;\n                }\n                meisai_data.number = Number(this.data.syouhin.second.number_per_box[meisai_data.size] * meisai_data.number_of_box) + Number(meisai_data.bara);\n\n            } else if (this.syouhin.second.niuke_unit == 1) {\n\n                if (meisai_data.number_of_box == undefined) {\n                    meisai_data.number = 0;\n                    return false;\n                }\n\n                meisai_data.number = meisai_data.number_of_box;\n            }\n\n\n            var total_of_box = this.totalCount(\"number_of_box\");\n            var total_of_bara = this.totalCount(\"bara\");\n            var total_number = this.totalCount(\"number\");\n\n            this.data.total.number_of_box = total_of_box;\n            this.data.total.bara = total_of_bara;\n            this.data.total.number = total_number;\n\n        },\n        totalCount: function (param) {\n\n            var result = 0;\n\n            for (var i = 0; i < this.data.second.model.meisai.length; i++) {\n\n                var target_number = this.data.second.model.meisai[i][param];\n\n                result += target_number;\n\n            }\n            return result;\n        },\n        niukeSearch: function () {\n\n\n            if (this.data.search.dateStart == \"\" || this.data.search.dateEnd == \"\") {\n\n                alert(\"日付が入力されていません\");\n\n                return false;\n            }\n            if (new Date(this.data.search.dateStart).getTime() > new Date(this.data.search.dateEnd).getTime()) {\n\n                alert(\"日付の関係が逆になっています\");\n\n                return false;\n            }\n\n            //検索を更新するときはresultを初期化\n            this.data.search.result = [];\n\n\n            var postUrl = url.niukeNyuryokuKensaku + \"?dateKagen=\" + this.data.search.dateStart + \"&dateJyogen=\" + this.data.search.dateEnd + \"&Syorikbn=\" + this.data.first.model.syoriKubun;\n\n            if (this.data.search.seisansya.code != \"\") {\n\n                postUrl += \"&seisansya=\" + this.data.search.seisansya.code;\n            } else {\n                postUrl += \"&seisansya=null\";\n            }\n\n\n            axios.get(postUrl)\n                .then(response => {\n\n                    console.log(response.data);\n                    for (var i = 0; i < response.data.length; i++) {\n\n                        var data = response.data[i];\n\n                        this.addSearchResult(data.date, data.reception_number, data.seisansya, data.syouhin, data.hinsyu, data.frequency, data.total, data.shizai, data.zentokin);\n\n                    }\n\n\n                })\n                .catch(response => console.log(response))\n\n\n        },\n        //クリックした検索結果を青くする\n        searchSelectedTr: function (index) {\n\n            this.data.search.selectedIndex = index;\n        },\n        searchResultSelect(search_result) {\n\n            this.data.receptionNumber = search_result.reception_number;\n            //モーダルを閉じる\n            this.data.dialogVisible = false;\n\n\n        },\n        getSyouhinData: function () {\n            //※ここで商品コードを元に商品データを取ってきてdata.syouhin.secondの中に入れる\n\n        },\n        init: function () {\n            //初期化\n            this.data.second.model.meisai = [];\n            this.data.search.result = [];\n            this.data.hinsyu = [];\n            this.data.second.model.niukeDate = \"\";\n            this.data.second.model.seisansyaCode = \"\";\n            this.data.second.model.seisansyaName = \"\";\n            this.data.syouhin.second.name = \"\";\n            this.data.second.model.hinsyuCode = \"\";\n            this.data.second.model.hinsyuName = \"\";\n            this.data.receptionNumber = \"\";\n            this.data.syoriKubun.second = \"0\";\n            this.data.total.kayoibako = 0;\n            this.data.disabled.niukeConfirm = false;\n            this.data.total.number_of_box = 0;\n            this.data.total.bara = 0;\n            this.data.total.number = 0;\n            this.data.shizaidai = 0;\n            this.data.zentokin = 0;\n\n\n        },\n        update: function () {\n\n            this.$refs['secondForm'].validate((valid) => {\n\n                if (valid) {\n\n                    if (this.data.syoriKubun.second == 0 && this.data.first.model.syoriKubun == 1) {\n\n                        if (this.data.second.model.meisai.length == 0) {\n                            alert(\"追加する行がありません\");\n                            return false;\n                        }\n                    }\n\n                    var message;\n                    if (this.data.syoriKubun.second == 0) {\n                        message = \"登録しますか？\";\n                    } else if (this.data.syoriKubun.second == 1) {\n                        message = \"更新しますか？\";\n                    } else if (this.data.syoriKubun.second == 2) {\n                        message = \"削除しますか？\";\n                    }\n\n                    if (window.confirm(message)) {\n\n                        var postArray = {\n                            \"Reception_number\": 0,\n                            \"Seisansyacd\": Number(this.data.second.model.seisansyaCode),\n                            \"SyoriKbn\": this.data.first.model.syoriKubun,\n                            \"Date\": this.data.second.model.niukeDate,\n                            \"Kaisu\": this.$store.state.login.kaisu,\n                            \"Syohin\": Number(this.data.syouhin.second.code),\n                            \"Hinsyu\": this.data.second.model.hinsyuCode,\n                            \"Nyuryokutantocd\": this.$store.state.login.userCode,\n                            \"Hakogoukei\": this.data.total.kayoibako,\n                            \"ShizaiDai\": this.data.shizaidai,\n                            \"MaewatasiKin\": this.data.zentokin,\n                            \"Nendo\": Number(this.data.second.model.niukeDate.split(\"-\")[0]),\n                            \"JikayoFlg\": 0,\n                            \"Data\": [],\n                        }\n                        if (this.data.first.model.jikayouChecked) {\n                            postArray.JikayoFlg = 1\n                        } \n\n\n                        if (this.data.first.model.syoriKubun == 9) {\n                            postArray.Hinsyu = 0;\n                        }\n\n                        if (this.data.receptionNumber != \"\") {\n                            postArray.Reception_number = Number(this.data.receptionNumber);\n                        }\n\n                   \n\n                        for (var i = 0; i < this.data.second.model.meisai.length; i++) {\n\n                            var data = this.data.second.model.meisai[i];\n\n                            if (data.number == \"\") {\n                                data.number = 0;\n                            }\n\n                            postArray.Data.push({\n                                \"Row\": i,\n                                \"Size\": data.size,\n                                \"Tokyu\": data.tokyu,\n                                \"Hako\": data.number_of_box,\n                                \"Bara\": data.bara,\n                                \"Suryo\": data.number,\n                                \"BikouCD\": data.note,\n                                \"HenpinRiyu\": data.reason_of_return,\n\n                            })\n\n\n\n                        }\n\n                        console.log(postArray);\n\n                        if (this.data.syoriKubun.second == 0) {\n\n                            axios.post(url.niukeNyuryoku, postArray)\n                                .then(response => {\n\n                                    this.$message({\n                                        message: '登録に成功しました',\n                                        type: 'success'\n                                    });\n\n                                    if (this.data.first.model.syoriKubun == 1) {\n\n                                        window.open(response.data.url)\n\n                                    } \n\n                                    this.init();\n                                })\n                                .catch(response => {\n\n                                    this.$message({\n                                        message: '通信に失敗しました',\n                                        type: 'error'\n                                    });\n                                    console.log(response)\n                                })\n\n\n                        } else if (this.data.syoriKubun.second == 1) {\n\n                            axios.put(url.niukeNyuryoku, postArray)\n                                .then(response => {\n                                   this.$message({\n                                        message: '修正に成功しました',\n                                        type: 'success'\n                                   });\n\n                                    if (this.data.first.model.syoriKubun == 1) {\n\n                                        if (window.confirm(\"再印刷しますか？\")) {\n                                            window.open(response.data.url)\n                                        }\n\n                                    } \n\n\n                                    this.init();\n                                 })\n                                .catch(response => {\n\n                                    this.$message({\n                                        message: '通信に失敗しました',\n                                        type: 'error'\n                                    });\n                                    console.log(response)\n                                })\n\n                        } else if (this.data.syoriKubun.second == 2) {\n\n                            postArray = {\n                                \"Reception_number\": this.data.receptionNumber \n                            }\n\n                            axios.delete(url.niukeNyuryoku, { params: postArray })\n                                .then(response => {\n                                    \n                                   this.$message({\n                                        message: '削除に成功しました',\n                                        type: 'success'\n                                   });\n\n                                    this.init();\n                                 })\n                                .catch(response => {\n\n                                    this.$message({\n                                        message: '通信に失敗しました',\n                                        type: 'error'\n                                    });\n                                    console.log(response)\n                                })\n\n                        }\n\n\n                    }\n\n                }\n            });\n\n        },\n        finish: function () {\n            this.$router.push('/hoshigaki/');  \n        },\n        getHinsyuSelect: function () {\n\n            var getUrl = url.createGetUrl(url.syohinHinsyuTokyuPatternMaster, [{ key: \"paramSyohin\", value: this.data.syouhin.second.code }, { key: \"paramNendo\", value: this.data.second.model.niukeDate.split(\"-\")[0] }]);\n            console.log(getUrl);\n            axios.get(getUrl)\n                .then(response => {\n\n                    for (var i = 0; i < response.data.length; i++) {\n\n                        var data = response.data[i];\n\n                        var is_exsist = false;\n\n                        for (var k = 0; k < this.data.hinsyu.length; k++) {\n\n                            if (data.hinsyuName == this.data.hinsyu[k].hinsyuName) {\n                                is_exsist = true;\n                            }\n                        }\n\n                        if (!is_exsist) {\n                            this.data.hinsyu.push(data);\n                        }\n\n                    }\n                    console.log(response.data);\n                })\n                .catch(response => console.log(response))\n\n\n        },\n        getMasterData: function (is_new, meisaiData) {\n            //各種必要なマスタデータを取ってくる\n\n            //※等級を取ってくる\n            axios.get(url.syohinSizeTokyuPatternMasterNiuke)\n                .then(response => {\n\n                    var Data = [];\n                    var syouhinCode = this.data.syouhin.second.code;\n\n                    for (var i = 0; i < response.data.length; i++) {\n                        var data = response.data[i];\n\n                        if (syouhinCode == data.syohinCD) {\n\n                            Data.push(data);\n                        }\n\n                    }\n\n\n                    var sizeData = [];\n                    var tokyuData = [];\n\n\n\n                    for (var i = 0; i < Data.length; i++) {\n\n                        var data = Data[i];\n\n\n                        var is_size_exsist = false;\n\n                        for (var k = 0; k < sizeData.length; k++) {\n\n                            if (sizeData[k].size == data.size) {\n                                is_size_exsist = true;\n                            }\n\n                        }\n\n                        if (!is_size_exsist) {\n                            sizeData.push(data);\n                        }\n\n\n                        var is_tokyu_exsist = false;\n\n                        for (var k = 0; k < tokyuData.length; k++) {\n                            if (tokyuData[k].tokyu == data.tokyu) {\n\n                                is_tokyu_exsist = true;\n                            }\n\n                        }\n\n                        if (!is_tokyu_exsist) {\n                            tokyuData.push(data);\n                        }\n                    }\n\n\n                    for (var i = 0; i < sizeData.length; i++) {\n\n                        var size = sizeData[i];\n\n                        if (Number(size.size) < 10) {\n\n                            this.data.size[\"0\" + size.size] = size.sizeHyojimei;\n\n                        } else {\n\n                            this.data.size[size.size] = size.sizeHyojimei;\n\n                        }\n\n                    }\n\n\n                    for (var i = 0; i < tokyuData.length; i++) {\n\n                        var tokyu = tokyuData[i];\n                        if (Number(size.size) < 10) {\n\n                            this.data.tokyu[\"0\" + tokyu.tokyu] = tokyu.tokyuHyojimei\n\n                        } else {\n\n                            this.data.tokyu[tokyu.tokyu] = tokyu.tokyuHyojimei\n\n                        }\n                    }\n\n\n                    console.log(this.data.size, this.data.tokyu);\n\n\n                    var getUrl = url.createGetUrl(url.sizeWaritukeMaster, [{ key: \"paramSyohin\", value: this.data.syouhin.second.code }]);\n\n\n\n                    axios.get(getUrl)\n                        .then(response => {\n                            console.log(\"商品:\", response.data);\n                            for (var i = 0; i < response.data.length; i++) {\n                                var data = response.data[i]\n                                this.data.syouhin.second.number_per_box[\"0\" + data.code] = data.irisu\n                            }\n\n\n\n\n\n                            axios.get(url.syouhinMaster)\n                                .then(response => {\n                                    for (var i in response.data) {\n                                        if (this.data.syouhin.second.code == response.data[i].syohinCD) {\n\n                                            this.data.syouhin.second.niuke_unit = response.data[i].niukeTani;\n                                        }\n                                    }\n\n\n                                    if (is_new) {\n\n\n                                    } else {\n\n\n                                        for (var i in meisaiData) {\n\n                                            this.addMeisai(meisaiData[i].code, meisaiData[i].size, meisaiData[i].tokyu, meisaiData[i].number_of_box, meisaiData[i].bara, meisaiData[i].number, meisaiData[i].note, meisaiData[i].henpinRiyu);\n\n                                        }\n\n                                    }\n\n                                    var total_of_box = this.totalCount(\"number_of_box\");\n                                    var total_of_bara = this.totalCount(\"bara\");\n                                    var total_number = this.totalCount(\"number\");\n\n                                    this.data.total.number_of_box = total_of_box;\n                                    this.data.total.bara = total_of_bara;\n                                    this.data.total.number = total_number;\n\n                                    this.data.disabled.niukeConfirm = true;\n\n\n\n                                })\n                                .catch(response => console.log(response))\n\n\n                        })\n                        .catch(response => console.log(response))\n\n\n\n\n                })\n                .catch(response => console.log(response))\n\n\n\n\n\n\n        },\n\n    },\n    created: function () {\n\n\n        //※返品理由を取ってくる\n\n        axios.get(url.henpinRiyuMaster)\n            .then(response => {\n\n                console.log(response.data);\n\n                for (var i = 0; i < response.data.length; i++) {\n\n                    var data = response.data[i];\n\n                    this.data.reason_of_return[data.key] = data.value;\n\n                }\n\n                console.log(this.data.reason_of_return);\n\n            })\n            .catch(response => console.log(response))\n\n\n        //※備考を取ってくる\n\n\n        axios.get(url.bikouMaster)\n            .then(response => {\n\n                console.log(response.data);\n\n                for (var i = 0; i < response.data.length; i++) {\n\n                    var data = response.data[i];\n\n                    this.data.note[data.key] = data.value;\n                }\n\n                console.log(this.data.note);\n\n            })\n            .catch(response => console.log(response))\n\n\n    },\n    mounted: function () {\n\n        //※荷受け日付(システム日付)\n        this.data.first.model.niukeDate = time.nowJapanDateInput();\n\n        //※端末番号\n        this.data.numberOfTerminal = this.$store.state.login.userCode;\n\n        //※荷受回数\n        this.data.first.model.kaisu = this.$store.state.login.kaisu;\n\n        this.data.search.dateStart = time.nowJapanDateInput();\n\n        this.data.search.dateEnd = time.nowJapanDateInput();\n\n    },\n    watch: {\n        'data.first.model.syoriKubun': function () {\n\n\n            if (this.data.first.model.syoriKubun == 9) {\n\n                for (var i in this.data.checked) {\n                    this.data.first.model.jikayouChecked = false;\n                    this.data.first.model.niukeHyouChecked = false;\n                    this.data.first.model.niukeHyouHikaeChecked = false;\n\n                }\n                this.data.first.validation.syouhinCode[0].required = false;\n\n\n            } else {\n                this.data.first.validation.syouhinCode[0].required = true;\n            }\n\n        },\n\n\n        \"data.syoriKubun.second\": function (new_value) {\n\n            if (new_value == 0) {\n\n                this.data.receptionNumber = \"\";\n                this.data.disabled.receptionNumber = true;\n                this.data.disabled.receptionNumberSearch = true;\n\n\n            } else if (new_value == 1 || new_value == 2) {\n\n                this.data.disabled.receptionNumber = false;\n                this.data.disabled.receptionNumberSearch = false;\n\n            }\n        },\n\n\n    }\n\n}\n",{"version":3,"sources":["NiukeNyuryoku.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+aA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;;;;AAIA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;AAIA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;;;AAIA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;AACA;;;;AAIA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;;;AAGA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;;AAGA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;AAIA;AACA;;;AAGA;AACA;;;;;AAKA;AACA;;;;;;;AAOA;;AAEA;AACA;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA","file":"NiukeNyuryoku.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n    <div>\r\n        <el-card v-if=\"data.pageNumber == 1\">\r\n            <div slot='header'>\r\n                <span>荷受伝票検索</span>\r\n            </div>\r\n            <div slot='default'>\r\n                <el-form :model=\"data.first.model\" :rules=\"data.first.validation\" ref=\"firstForm\" label-width=\"120px\" class=\"demo-ruleForm\">\r\n                    <div class=\"row\">\r\n                        <div class='col-md-3'>\r\n                            <label for='処理区分' class='col-form-label px-1' style='width:100%;'>処理区分</label>\r\n                            <el-form-item label-width=\"0\" prop=\"syoriKubun\">\r\n                                <el-select id=\"syoriKubun\" v-model=\"data.first.model.syoriKubun\" style=\"width: 100%;\">\r\n                                    <el-option :value='1' label=\"1:実行\"></el-option>\r\n                                    <el-option :value='9' label=\"9:資材代\"></el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <label for='荷受日付' class='col-form-label px-1' style='width:100%;'>荷受日付</label>\r\n                            <el-form-item label-width=\"0\" prop=\"niukeDate\">\r\n                                <el-input v-model=\"data.first.model.niukeDate\"\r\n                                          type='date'\r\n                                          min='1000-01-01'\r\n                                          max='9999-12-31'></el-input>\r\n                            </el-form-item>\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <label for='回数' class='col-form-label px-1' style='width:100%;'>回数</label>\r\n                            <el-form-item label-width=\"0\" prop=\"kaisu\">\r\n                                <el-input style=\"width:100%;\"\r\n                                                 v-model=\"data.first.model.kaisu\"\r\n                                                 readonly></el-input>\r\n                            </el-form-item>\r\n\r\n                        </div>\r\n                        <div class='col-md-3'>\r\n                            <label for='端末番号' class='col-form-label px-1' style='width:100%;'>端末番号</label>\r\n                            <el-input type='text'\r\n                                      v-model=\"data.numberOfTerminal\"\r\n                                      readonly></el-input>\r\n                        </div>\r\n                    </div>\r\n                    <div class='row'>\r\n                        <div class='col-md-6'>\r\n                            <label for='商品区分' class='col-form-label px-1' style='width:100%;'>商品区分</label>\r\n                            <el-form-item label-width=\"0\" prop=\"syouhinCode\">\r\n                                <el-increment-search v-model=\"data.first.model.syouhinCode\"\r\n                                                     :display=\"[{key:'syohinmei',name:'名前'}]\"\r\n                                                     :autoComplete=\"['syohinmei']\"\r\n                                                     :kind=\"'商品'\"\r\n                                                     :required=\"true\"\r\n                                                     @update=\"(r) => data.first.model.syouhinName = r.syohinmei\"></el-increment-search>\r\n                                <el-input type='text'\r\n                                          style='width:50%;'\r\n                                          readonly\r\n                                          :placeholder=\"'商品名'\"\r\n                                          v-model=\"data.first.model.syouhinName\"></el-input>\r\n                            </el-form-item>\r\n\r\n                        </div>\r\n                    </div>\r\n                    <div class='row'>\r\n                        <div class='col-md-4'>\r\n                            <label for='自家用' class='col-form-label px-1' style=\"margin-right:2%;\">自家用</label>\r\n                            <el-checkbox v-model=\"data.first.model.jikayouChecked\" :disabled=\"data.first.model.syoriKubun == 9\"></el-checkbox>\r\n                        </div>\r\n                        <div class='col-md-4'>\r\n                            <label for='荷受表印刷' class='col-form-label px-1' style=\"margin-right:2%;\">荷受表を印刷する</label>\r\n                            <el-checkbox v-model=\"data.first.model.niukeHyouChecked\" :disabled=\"data.first.model.syoriKubun == 9\"></el-checkbox>\r\n                        </div>\r\n                        <div class='col-md-4'>\r\n                            <label for='荷受表控印刷' class='col-form-label px-1' style=\"margin-right:2%;\">荷受表(控)を印刷する</label>\r\n                            <el-checkbox v-model=\"data.first.model.niukeHyouHikaeChecked\" :disabled=\"data.first.model.syoriKubun == 9\"></el-checkbox>\r\n                        </div>\r\n                    </div>\r\n\r\n                </el-form>\r\n                <div class='row'>\r\n                    <div class='col-md-12'>\r\n                        <div style='text-align:right;width:100%;'>\r\n                            <el-button style='margin-left:2%;' type='primary' v-on:click=\"searchCheck\">検索(F5)</el-button>\r\n                            <el-button style='margin-left:2%;' type='warning' v-on:click=\"finish\">終了(F12)</el-button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </el-card>\r\n\r\n        <keyboard-events v-on:keydown=\"keyboardEvent\"></keyboard-events>\r\n        <el-dialog title=\"荷受データ検索\"\r\n                   :visible.sync=\"data.dialogVisible\"\r\n                   width=\"90%\">\r\n            <div class=\"row\">\r\n                <div class='col-md-12'>\r\n                    <label for='荷受日付' class='col-form-label px-1' style='width:100%;'>荷受日付</label>\r\n                    <el-input type='date'\r\n                              style='width:40%;margin-right:2%;'\r\n                              :max=\"data.search.dateEnd\"\r\n                              v-model='data.search.dateStart'></el-input>\r\n                    <span>～</span>\r\n                    <el-input type='date'\r\n                              style='width:40%;margin-right:2%;'\r\n                              :min=\"data.search.dateStart\"\r\n                              v-model='data.search.dateEnd'></el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"row\">\r\n                <div class='col-md-8'>\r\n                    <label for='生産者' class='col-form-label px-1' style='width:100%;'>生産者</label>\r\n                    <el-increment-search v-model=\"data.search.seisansya.code\"\r\n                                         :display=\"[{key:'seisansyamei',name:'名前'}]\"\r\n                                         :autoComplete=\"['seisansyamei']\"\r\n                                         :kind=\"'生産者'\"\r\n                                         :required=\"true\"\r\n                                         @update=\"(r) => data.search.seisansya.name = r.seisansyamei\"></el-increment-search>\r\n                    <el-input type='text'\r\n                              style='width:50%;'\r\n                              readonly\r\n                              :placeholder=\"'生産者名'\"\r\n                              v-model=\"data.search.seisansya.name\"></el-input>\r\n                </div>\r\n            </div>\r\n            <div class=\"row\">\r\n                <div class=\"col-12\" style=\"text-align:right;\">\r\n                    <el-button @click=\"data.dialogVisible = false\">終了</el-button>\r\n                    <el-button type=\"primary\" v-on:click=\"niukeSearch\">検索</el-button>\r\n                </div>\r\n            </div>\r\n            <el-card style=\"margin-top:1%;\">\r\n                <div slot='header'>\r\n                    <span>検索結果</span>\r\n                </div>\r\n                <div slot='default' class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <table class=\"table\">\r\n                            <thead>\r\n                                <tr class=\"bold-border-bottom\">\r\n                                    <th width=\"4%\"></th>\r\n                                    <th>日付</th>\r\n                                    <th>受付番号</th>\r\n                                    <th>生産者</th>\r\n                                    <th>商品</th>\r\n                                    <th>品種</th>\r\n                                    <th>回数</th>\r\n                                    <th>通箱合計</th>\r\n                                    <th>資材代</th>\r\n                                    <th>前渡金</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"(search_result, index) in data.search.result\" v-bind:key=\"search_result.number\" v-bind:class=\"data.search.selectedIndex == index ? 'bold-border-bottom search-selected' : 'bold-border-bottom'\" v-on:click=\"searchSelectedTr(index)\">\r\n                                    <td><el-button type=\"success\" name=\"name\" v-on:click=\"searchResultSelect(search_result)\">選択</el-button></td>\r\n                                    <td>{{search_result.date}}</td>\r\n                                    <td>{{search_result.reception_number}}</td>\r\n                                    <td>{{search_result.seisansya}}</td>\r\n                                    <td>{{search_result.syouhin}}</td>\r\n                                    <td>{{search_result.hinsyu}}</td>\r\n                                    <td>{{search_result.frequency}}</td>\r\n                                    <td>{{search_result.total}}</td>\r\n                                    <td>{{search_result.shizai}}</td>\r\n                                    <td>{{search_result.zentokin}}</td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </el-card>\r\n        </el-dialog>\r\n        <el-card v-if=\"data.pageNumber == 2\">\r\n            <div slot='header'>\r\n                <span>荷受伝票</span>\r\n            </div>\r\n            <div slot='default'>\r\n                <el-form :model=\"data.second.model\" ref=\"secondForm\" label-width=\"120px\" class=\"demo-ruleForm\">\r\n                    <div class='row'>\r\n                        <div class='col-md-12'>\r\n\r\n                            <el-card>\r\n                                <template slot='default'>\r\n                                    <div class='row'>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='処理区分' class='col-form-label px-1' style='width:100%;'>処理区分</label>\r\n                                            <el-select id=\"syoriKubun\" v-model=\"data.syoriKubun.second\" style='width:100%;' :disabled=\"data.disabled.niukeConfirm\">\r\n                                                <el-option value='0' label=\"0: 新規\"></el-option>\r\n                                                <el-option value='1' label=\"1: 修正\"></el-option>\r\n                                                <el-option value='2' label=\"2: 削除\"></el-option>\r\n                                            </el-select>\r\n                                        </div>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='荷受日付' class='col-form-label px-1' style='width:100%;'>受付番号</label>\r\n                                            <el-input id=\"receptionNumber\"\r\n                                                      type='text'\r\n                                                      style='width:60%; margin-right:2%;'\r\n                                                      v-model=\"data.receptionNumber\"\r\n                                                      :disabled=\"data.syoriKubun.second == 0 || data.disabled.niukeConfirm\"></el-input>\r\n                                            <el-button id=\"receptionNumberSearch\"\r\n                                                       type='danger'\r\n                                                       icon=\"el-icon-search\"\r\n                                                       style='width:20%;display:inline;'\r\n                                                       @click=\"data.dialogVisible = true\"\r\n                                                       :disabled=\"data.syoriKubun.second == 0 || data.disabled.niukeConfirm\">検索</el-button>\r\n\r\n                                        </div>\r\n                                        <div class='col-md-4'>\r\n                                            <label for='回数' class='col-form-label px-1'>確認</label>\r\n                                            <el-button type='primary'\r\n                                                       style=\"display:block;\"\r\n                                                       v-on:click=\"niukeConfirm\">確認</el-button>\r\n                                        </div>\r\n                                    </div>\r\n                                </template>\r\n                            </el-card>\r\n                        </div>\r\n                    </div>\r\n                    <div class='row' style=\"margin-top:3%;\">\r\n                        <div class='col-md-6'>\r\n                            <label for='荷受日付' class='col-form-label px-1'>荷受日付</label>\r\n                            <el-form-item label-width=\"0\"\r\n                                          prop=\"niukeDate\"\r\n                                          :rules=\"{\r\n                                                              required: true, message: '荷受日付が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                          style=\"margin:0;\">\r\n                                <el-input id=\"niukeDate\"\r\n                                          type=\"date\"\r\n                                          v-model=\"data.second.model.niukeDate\" v-bind:disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second != 1\"></el-input>\r\n                            </el-form-item>\r\n                        </div>\r\n                    </div>\r\n                    <div class='row'>\r\n                        <div class='col-md-4'>\r\n                            <label for='生産者' class='col-form-label px-1' style='width:100%;'>生産者</label>\r\n                            <el-form-item label-width=\"0\"\r\n                                          prop=\"seisansyaCode\"\r\n                                          :rules=\"{\r\n                                                              required: true, message: '生産者が入力されていません', trigger: 'change'\r\n                                                              }\"\r\n                                          style=\"margin:0;\">\r\n                                <el-increment-search v-model=\"data.second.model.seisansyaCode\"\r\n                                                     :display=\"[{key:'seisansyamei',name:'名前'}]\"\r\n                                                     :autoComplete=\"['seisansyamei']\"\r\n                                                     :kind=\"'生産者'\"\r\n                                                     :required=\"true\"\r\n                                                     @update=\"(r) => data.second.model.seisansyaName = r.seisansyamei\"\r\n                                                     :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"></el-increment-search>\r\n                                <el-input type='text'\r\n                                          style='width:50%;'\r\n                                          readonly\r\n                                          :placeholder=\"'生産者名'\"\r\n                                          :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"\r\n                                          v-model=\"data.second.model.seisansyaName\"></el-input>\r\n                            </el-form-item>\r\n\r\n\r\n                        </div>\r\n                        <div class='col-md-4'>\r\n                            <label for='商品名' class='col-form-label px-1' style='width:100%;'>商品名</label>\r\n                            <el-input id=\"syouhinName\"\r\n                                      type='text'\r\n                                      v-model=\"data.syouhin.second.name\"\r\n                                      readonly\r\n                                      v-bind:disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"></el-input>\r\n                        </div>\r\n                        <div class='col-md-4' v-if=\"data.first.model.syoriKubun == 1\">\r\n                            <label for='品種' class='col-form-label px-1' style='width:100%;'>品種</label>\r\n                            <el-form-item label-width=\"0\"\r\n                                          prop=\"hinsyuCode\"\r\n                                          :rules=\"{\r\n                                                              required: true, message: '品種が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                          style=\"margin:0;\">\r\n                                <el-select name=\"name\" v-model=\"data.second.model.hinsyuCode\" v-bind:disabled=\"data.syoriKubun.second == 2 || data.first.model.syoriKubun != 1 || !data.disabled.niukeConfirm\">\r\n                                    <el-option v-for=\"hinsyu in data.hinsyu\" :key=\"hinsyu.number\" :value=\"hinsyu.hinsyu\" :label=\"hinsyu.hinsyuName\"></el-option>\r\n                                </el-select>\r\n                            </el-form-item>\r\n\r\n\r\n                        </div>\r\n                    </div>\r\n                    <el-card style=\"margin-top:3%;\">\r\n                        <div slot='header'>\r\n                            <span>明細</span>\r\n                        </div>\r\n                        <div>\r\n                            <table class=\"table\">\r\n                                <thead>\r\n                                    <tr class=\"bold-border-bottom\">\r\n                                        <th width=\"4%\"></th>\r\n                                        <th>削除</th>\r\n                                        <th>コード</th>\r\n                                        <th>サイズ</th>\r\n                                        <th>等級</th>\r\n                                        <th>箱数</th>\r\n                                        <th>バラ</th>\r\n                                        <th width=\"10%\">数量</th>\r\n                                        <th width=\"10%\">備考</th>\r\n                                        <th width=\"10%\">返品理由</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                    <tr v-for=\"(meisai_data, index) in data.second.model.meisai\" v-bind:key=\"meisai_data.number\" class=\"bold-border-bottom\">\r\n                                        <td>{{index}}</td>\r\n                                        <td><el-button type=\"primary\" name=\"name\" v-on:click=\"meisaiRemove(index)\" v-bind:disabled=\"data.syoriKubun.second == 2\">削除</el-button></td>\r\n                                        <td>\r\n                                            <el-form-item label-width=\"0\"\r\n                                                          :prop=\"'meisai[' + index + '].code'\"\r\n                                                          :rules=\"{\r\n                                                              required: true, message: 'コードが入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                          style=\"margin:0;\">\r\n\r\n                                                <input class=\"form-control\" type=\"text\" name=\"name\" v-bind:value=\"meisai_data.code\" v-on:change=\"meisaiCodeCheck(meisai_data,$event.target,index)\" v-bind:disabled=\"data.syoriKubun.second == 2\" />\r\n                                            </el-form-item>\r\n                                        </td>\r\n                                        <td>\r\n                                            <el-input :value=\"data.size[meisai_data.size]\"\r\n                                                      :disabled=\"data.syoriKubun.second == 2\"\r\n                                                      readonly></el-input>\r\n                                        </td>\r\n                                        <td>\r\n                                            <el-input :value=\"data.tokyu[meisai_data.tokyu]\"\r\n                                                      :disabled=\"data.syoriKubun.second == 2\"\r\n                                                      readonly></el-input>\r\n                                        </td>\r\n                                        <td>\r\n                                            <el-form-item label-width=\"0\"\r\n                                                          :prop=\"'meisai[' + index + '].number_of_box'\"\r\n                                                          :rules=\"{\r\n                                                              required: true, message: '箱数が入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                          style=\"margin:0;\">\r\n                                                <el-input-number :min=\"0\" name=\"name\" controls-position=\"right\" v-model=\"meisai_data.number_of_box\" @change=\"numberChange(meisai_data,$event.target,'箱数')\" :disabled=\"data.syoriKubun.second == 2\"></el-input-number>\r\n                                            </el-form-item>\r\n                                        </td>\r\n                                        <td>\r\n                                            <el-form-item label-width=\"0\"\r\n                                                          :prop=\"'meisai[' + index + '].bara'\"\r\n                                                          :rules=\"{\r\n                                                              required: true, message: 'バラが入力されていません', trigger: 'blur'\r\n                                                              }\"\r\n                                                          style=\"margin:0;\">\r\n\r\n                                                <el-input-number :min=\"0\" name=\"name\" controls-position=\"right\" v-bind:disabled=\"data.syouhin.second.niuke_unit != 0 || data.syoriKubun.second == 2\" v-model=\"meisai_data.bara\" @change=\"numberChange(meisai_data,$event.target,'バラ')\"></el-input-number>\r\n                                            </el-form-item>\r\n                                        </td>\r\n                                        <td><el-input name=\"name\" v-model=\"meisai_data.number\" readonly v-bind:disabled=\"data.syoriKubun.second == 2\"></el-input></td>\r\n                                        <td>\r\n                                            <el-select name=\"name\" v-model=\"meisai_data.note\" v-bind:disabled=\"data.syoriKubun.second == 2\">\r\n                                                <el-option v-for=\"(note_option,index_key) in data.note\" :key=\"note_option.number\" :value=\"Number(index_key)\" :label=\"note_option\"></el-option>\r\n                                            </el-select>\r\n                                        </td>\r\n                                        <td>\r\n                                            <el-select name=\"name\" v-model=\"meisai_data.reason_of_return\" v-bind:disabled=\"data.syoriKubun.second == 2\">\r\n                                                <el-option v-for=\"(reason_option,index_key) in data.reason_of_return\" :key=\"reason_option.number\" :value=\"Number(index_key)\" :label=\"reason_option\"></el-option>\r\n                                            </el-select>\r\n                                        </td>\r\n\r\n                                    </tr>\r\n                                </tbody>\r\n                                <tr>\r\n                                    <td colspan=\"10\" style=\"text-align:center;\">\r\n                                        <el-button type='primary'\r\n                                                   style='width:40%;display:inline;'\r\n                                                   @click=\"addMeisai('', null, null, 0, 0,0, 0, 0)\"\r\n                                                   :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2 || data.first.model.syoriKubun != 1\">明細を追加</el-button>\r\n                                    </td>\r\n                                </tr>\r\n                                <tbody>\r\n                                    <tr>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td>合計</td>\r\n                                        <td><el-input v-model=\"data.total.number_of_box\" readonly :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"></el-input></td>\r\n                                        <td><el-input v-model=\"data.total.bara\" readonly :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"></el-input></td>\r\n                                        <td><el-input v-model=\"data.total.number\" readonly :disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2\"></el-input></td>\r\n                                    </tr>\r\n                                    <tr>\r\n                                    <tr>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td></td>\r\n                                        <td>通箱合計</td>\r\n                                        <td><el-input-number v-model=\"data.total.kayoibako\" \r\n                                                             v-bind:disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2 || data.first.model.syoriKubun != 1\"\r\n                                                             controls-position=\"right\"\r\n                                                             ></el-input-number></td>\r\n                                    </tr>\r\n                                </tbody>\r\n                            </table>\r\n                            <div class='row'>\r\n                                <div class='col-md-4'>\r\n                                    <label for='資材代' class='col-form-label px-1' style='width:100%;'>資材代</label>\r\n                                    <el-input-number type='text'\r\n                                                     v-model=\"data.shizaidai\"\r\n                                                     readonly\r\n                                                     v-bind:disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2 || data.first.model.syoriKubun != 9\"\r\n                                                     controls-position=\"right\"\r\n                                                     :min=\"0\"\r\n                                                     style='width:100%;'></el-input-number>\r\n                                </div>\r\n                                <div class='col-md-4'>\r\n                                    <label for='前渡金' class='col-form-label px-1' style='width:100%;'>前渡金</label>\r\n                                    <el-input-number type='text'\r\n                                                     v-model=\"data.zentokin\"\r\n                                                     readonly\r\n                                                     v-bind:disabled=\"!data.disabled.niukeConfirm || data.syoriKubun.second == 2 || data.first.model.syoriKubun != 9\"\r\n                                                     controls-position=\"right\"\r\n                                                     :min=\"0\"\r\n                                                     style='width:100%;'></el-input-number>\r\n                                </div>\r\n                            </div>\r\n                            <div style='text-align:right;width:100%;'>\r\n                                <el-button id=\"updateButton\" type='success' v-bind:disabled=\"!data.disabled.niukeConfirm\" v-on:click=\"update\">{{data.updateButton}}(F9)</el-button>\r\n                                <el-button style='margin-left:2%;' type='warning' v-on:click=\"init\">画面クリア(F10)</el-button>\r\n                                <el-button style='margin-left:2%;' type='primary' v-on:click=\"finish\">終了(F12)</el-button>\r\n                            </div>\r\n                        </div>\r\n                    </el-card>\r\n                </el-form>\r\n            </div>\r\n        </el-card>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    // @ is an alias to /src\r\n    import KeyboardEvents from '@/components/KeyboardEvents.vue'\r\n    import config from '@/config.js'\r\n    import validation from '@/js/status/validation.js'\r\n    import ElIncrementSearch from '@/components/IncrementSearch.vue'\r\n    import time from '@/js/status/time.js'\r\n    import url from '@/js/api_url.js'\r\n\r\n    export default {\r\n        name: 'niukeNyuryoku',\r\n        components: {\r\n            KeyboardEvents, ElIncrementSearch\r\n        },\r\n        data: function () {\r\n            return {\r\n                state1: \"\",\r\n                //methodsで使う際のnodeをmountedで登録し、取得する手間を省く\r\n                element: {\r\n                    niukeDate: null,\r\n                    syoriKubun: null,\r\n                    receptionNumber: null,\r\n                    receptionNumberSearch: null,\r\n                    syouhinName: null,\r\n                    hinsyuCode: null,\r\n                    updateButton: null,\r\n                },\r\n                data: {\r\n                    pageNumber: 1,\r\n                    numberOfTerminal: null,\r\n                    search: {\r\n                        dateStart: \"\",\r\n                        dateEnd: \"\",\r\n                        seisansya: {\r\n                            code: \"\",\r\n                            name: \"\",\r\n                        },\r\n                        result: [\r\n                        ],\r\n                        selectedIndex: null,\r\n                    },\r\n                    first: {\r\n                        model: {\r\n                            syoriKubun: 1,\r\n                            niukeDate: \"\",\r\n                            kaisu: 0,\r\n                            syouhinName: \"\",\r\n                            syouhinCode: \"\",\r\n                            jikayouChecked: false,\r\n                            niukeHyouChecked: true,\r\n                            niukeHyouHikaeChecked: true,\r\n                        },\r\n                        validation: {\r\n                            syoriKubun: [\r\n                                { required: true, message: '処理区分が入力されていません', trigger: 'blur' },\r\n                            ],\r\n                            niukeDate: [\r\n                                { required: true, message: '荷受日付が入力されていません', trigger: 'blur' },\r\n                            ],\r\n                            kaisu: [\r\n                                { required: true, message: '回数が入力されていません', trigger: 'blur' },\r\n                            ],\r\n                            syouhinCode: [\r\n                                { required: true, message: '商品コードが入力されていません', trigger: 'change' },\r\n                            ]\r\n                        }\r\n                    },\r\n                    second: {\r\n                        model: {\r\n                            niukeDate: \"\",\r\n                            seisansyaCode: \"\",\r\n                            seisansyaName: \"\",\r\n                            hinsyuCode: \"\",\r\n                            meisai: [],\r\n                        },\r\n                    },\r\n                    //更新ボタンの文字\r\n                    updateButton: \"更新\",\r\n                    disabled: {\r\n                        niukeConfirm: false,\r\n                    },\r\n                    shizaidai: 0,\r\n                    zentokin: 0,\r\n                    dialogVisible: false,\r\n                    total: {\r\n                        number_of_box: 0,\r\n                        bara: 0,\r\n                        number: 0,\r\n                        kayoibako: 0,\r\n                    },\r\n                    //処理区分、第一画面の処理区分はfirst、第二画面はsecond\r\n                    syoriKubun: {\r\n                        first: \"0\",\r\n                        second: \"0\"\r\n                    },\r\n                    syouhin: {\r\n                        first: {\r\n                            name: \"\",\r\n                            code: \"\",\r\n                        },\r\n                        second: {\r\n                            code: \"\",\r\n                            name: \"\",\r\n                            niuke_unit: \"\",\r\n                            //キーをサイズコードにして、サイズ毎の入数を呼び出す\r\n                            number_per_box: {\r\n                            }\r\n                            ,\r\n                        },\r\n\r\n                    },\r\n                    receptionNumber: \"\",\r\n                    //荷受日付、フォーマットはinputのdateに格納できるstringの形で、\r\n                    niukeDate: {\r\n                        first: '',\r\n                        second: \"\"\r\n                    },\r\n                    seisansya: {\r\n                        code: \"\",\r\n                        name: \"\"\r\n                    },\r\n                    note: {},\r\n                    reason_of_return: {},\r\n                    size: {\r\n                    },\r\n                    tokyu: {\r\n                    },\r\n                    hinsyu: [\r\n                    ],\r\n\r\n                },\r\n            }\r\n        },\r\n        methods: {\r\n            keyboardEvent(e) {\r\n                if (e.keyCode == config.KEY_CODES.F5) {\r\n                    if (this.data.pageNumber == 1) {\r\n                        this.searchCheck();\r\n                    }\r\n\r\n                }\r\n\r\n                if (e.keyCode == config.KEY_CODES.F9) {\r\n\r\n                    if (this.data.pageNumber == 2) {\r\n                        this.update()\r\n                    }\r\n\r\n                }\r\n                if (e.keyCode == config.KEY_CODES.F10) {\r\n                    if (this.data.pageNumber == 2) {\r\n                        this.init()\r\n                    }\r\n                }\r\n                if (e.keyCode == config.KEY_CODES.F12) {\r\n                    this.finish()\r\n                }\r\n            },\r\n            searchCheck: function () {\r\n\r\n                this.$refs['firstForm'].validate((valid) => {\r\n\r\n                    if (valid) {\r\n                        this.data.pageNumber = 2;\r\n                    }\r\n                });\r\n\r\n            },\r\n\r\n            createMeisaiData: function (code, size, tokyu, number_of_box, bara, number, note, reason_of_return) {\r\n\r\n                return {\r\n                    code: code,\r\n                    size: size,\r\n                    tokyu: tokyu,\r\n                    number_of_box: number_of_box,\r\n                    bara: bara,\r\n                    number: number,\r\n                    note: note,\r\n                    reason_of_return: reason_of_return\r\n                };\r\n\r\n            },\r\n            addMeisai: function (code, size, tokyu, number_of_box, bara, number, note, reason_of_return) {\r\n\r\n                var data = this.createMeisaiData(code, size, tokyu, number_of_box, bara, number, note, reason_of_return);\r\n\r\n                this.data.second.model.meisai.push(data);\r\n\r\n\r\n            },\r\n            createSearchResultData: function (date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin) {\r\n\r\n                return {\r\n                    date: date,\r\n                    reception_number: reception_number,\r\n                    seisansya: seisansya,\r\n                    syouhin: syouhin,\r\n                    hinsyu: hinsyu,\r\n                    frequency: frequency,\r\n                    total: total,\r\n                    shizai: shizai,\r\n                    zentokin: zentokin,\r\n                };\r\n\r\n            },\r\n            addSearchResult: function (date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin) {\r\n\r\n                var data = this.createSearchResultData(date, reception_number, seisansya, syouhin, hinsyu, frequency, total, shizai, zentokin);\r\n\r\n                this.data.search.result.push(data);\r\n\r\n\r\n            },\r\n            niukeConfirm: function () {\r\n                //仕様書を見た感じ提出前にチェックする必要性が無いように感じるが、もし入力チェックがある場合はここに追加\r\n\r\n                var select_value = this.data.syoriKubun.second;\r\n\r\n                if (select_value == 0) {\r\n                    //新規の時\r\n\r\n                    //第一画面の荷受け日付を第二画面の荷受け日付に変える\r\n                    this.data.second.model.niukeDate = this.data.first.model.niukeDate;\r\n\r\n                    //第一画面の商品区分を元に商品名プロパティに入れる。そのデータを取ってくる。とりあえず定数を入れておくので変えてください。\r\n                    this.data.syouhin.second.code = this.data.first.model.syouhinCode;\r\n                    this.data.syouhin.second.name = this.data.first.model.syouhinName;\r\n\r\n                    this.getHinsyuSelect()\r\n\r\n                    //更新ボタンの中身編集\r\n                    this.data.updateButton = \"新規\"\r\n\r\n                    this.getMasterData(true);\r\n\r\n\r\n                } else if (select_value == 1 || select_value == 2) {\r\n\r\n                    if (this.data.receptionNumber == \"\") {\r\n                        alert(\"受付番号を検索してください\");\r\n                        return false;\r\n                    }\r\n\r\n\r\n\r\n                    //※ここでaxiosで荷受け番号をもとにT荷受けからデータを取ってくる\r\n\r\n\r\n                    axios.get(url.niukeNyuryoku + \"?reception_number=\" + this.data.receptionNumber)\r\n                        .then(response => {\r\n\r\n                            console.log(response.data);\r\n\r\n                            var data = response.data[0];\r\n\r\n                            if (data.meisaiData.length == 0) {\r\n\r\n                                alert(\"データがありません\");\r\n                                return false;\r\n                            }\r\n\r\n                            //検索で選択したデータを明細に追加する。とりあえずは適当なデータを明細に入れるので、後にdbから取ってくる\r\n                            //明細の行を初期化\r\n                            this.data.second.model.meisai = [];\r\n\r\n                            this.data.second.model.niukeDate = data.date;\r\n                            this.data.second.model.seisansyaCode = String(data.seisansyacd);\r\n                            this.data.second.model.seisansyaName = data.seisansya;\r\n                            this.data.syouhin.second.name = data.syohin;\r\n                            this.data.syouhin.second.code = data.syohincd;\r\n\r\n                            this.data.total.kayoibako = data.total;\r\n                            this.data.shizaidai = data.shizai;\r\n                            this.data.zentokin = data.zentokin;\r\n\r\n                            console.log(\"商品コード:\", this.data.syouhin.second.code);\r\n                            this.getHinsyuSelect()\r\n\r\n                            this.data.second.model.hinsyuCode = data.hinsyucd;\r\n\r\n                            console.log(this.data.second.model.hinsyuCode);\r\n\r\n                            if (select_value == 2) {\r\n                                //更新ボタンの中身編集\r\n                                this.data.updateButton = \"削除\"\r\n\r\n                            } else if (select_value == 1) {\r\n                                this.data.updateButton = \"編集\"\r\n                            }\r\n\r\n                            this.getMasterData(false, data.meisaiData);\r\n\r\n                        })\r\n                        .catch(response => console.log(response))\r\n\r\n                }\r\n\r\n\r\n\r\n            },\r\n            meisaiRemove: function (index) {\r\n\r\n                if (this.data.second.model.meisai.length > 1) {\r\n\r\n                    //明細の削除\r\n                    this.data.second.model.meisai.splice(index, 1);\r\n\r\n                }\r\n            },\r\n            //明細のコードの入力チェック\r\n            meisaiCodeCheck: function (meisai_data, input, index) {\r\n\r\n                var input_code = input.value;\r\n\r\n                //数値バリデーション\r\n                if (!validation.validation.is_intager_filling_zero(input_code)) {\r\n\r\n                    alert(validation.error_message.is_intager_filling_zero(\"コード\"));\r\n\r\n                    input.value = meisai_data.code;\r\n                    return false;\r\n\r\n                }\r\n\r\n\r\n                if (input_code.length != 4) {\r\n\r\n                    alert(\"文字数は4桁である必要があります。\");\r\n                    input.value = meisai_data.code;\r\n                    return false;\r\n                }\r\n\r\n                var size_code = input_code.substr(0, 2);\r\n                var tokyu_code = input_code.substr(2, 2);\r\n\r\n                var size_name = this.sizeSearch(size_code);\r\n                var tokyu_name = this.tokyuSearch(tokyu_code);\r\n\r\n                if (size_name == undefined) {\r\n\r\n                    alert(\"サイズがありません\");\r\n                    input.value = meisai_data.code;\r\n                    return false;\r\n                }\r\n\r\n                if (tokyu_name == undefined) {\r\n\r\n                    alert(\"等級がありません\");\r\n                    input.value = meisai_data.code;\r\n                    return false;\r\n                }\r\n\r\n                meisai_data.size = size_code;\r\n                meisai_data.tokyu = tokyu_code;\r\n                meisai_data.code = input.value;\r\n\r\n                this.numberChange(meisai_data);\r\n\r\n\r\n            },\r\n            sizeSearch: function (size) {\r\n\r\n\r\n\r\n                //検索して、ものがあれば名称を返し、無ければundefinedで返す\r\n                var result;\r\n\r\n                var is_exist = false;\r\n                var key;\r\n                for (var i in this.data.size) {\r\n\r\n                    if (i == size) {\r\n\r\n                        is_exist = true;\r\n                        key = i;\r\n\r\n                    }\r\n\r\n                }\r\n                if (is_exist) {\r\n                    result = this.data.size[key];\r\n                }\r\n\r\n                return result\r\n\r\n            },\r\n            tokyuSearch: function (tokyu) {\r\n\r\n\r\n                //検索して、ものがあれば名称を返し、無ければundefinedで返す\r\n                var result;\r\n\r\n                var is_exist = false;\r\n                var key;\r\n                for (var i in this.data.tokyu) {\r\n\r\n                    if (i == tokyu) {\r\n\r\n                        is_exist = true;\r\n                        key = i;\r\n                    }\r\n\r\n                }\r\n\r\n                if (is_exist) {\r\n                    result = this.data.tokyu[key];\r\n                }\r\n\r\n                return result;\r\n\r\n            },\r\n            //箱数またはバラの値を変化させた時の処理,paramは箱数かバラかのパラメーター\r\n            numberChange: function (meisai_data) {\r\n\r\n\r\n                if (this.data.syouhin.second.niuke_unit == 0) {\r\n  \r\n                    if (meisai_data.number_of_box == undefined || meisai_data.size == null || meisai_data.bara == undefined) {\r\n\r\n                        meisai_data.number = 0;\r\n\r\n                        return false;\r\n                    }\r\n                    meisai_data.number = Number(this.data.syouhin.second.number_per_box[meisai_data.size] * meisai_data.number_of_box) + Number(meisai_data.bara);\r\n\r\n                } else if (this.syouhin.second.niuke_unit == 1) {\r\n\r\n                    if (meisai_data.number_of_box == undefined) {\r\n                        meisai_data.number = 0;\r\n                        return false;\r\n                    }\r\n\r\n                    meisai_data.number = meisai_data.number_of_box;\r\n                }\r\n\r\n\r\n                var total_of_box = this.totalCount(\"number_of_box\");\r\n                var total_of_bara = this.totalCount(\"bara\");\r\n                var total_number = this.totalCount(\"number\");\r\n\r\n                this.data.total.number_of_box = total_of_box;\r\n                this.data.total.bara = total_of_bara;\r\n                this.data.total.number = total_number;\r\n\r\n            },\r\n            totalCount: function (param) {\r\n\r\n                var result = 0;\r\n\r\n                for (var i = 0; i < this.data.second.model.meisai.length; i++) {\r\n\r\n                    var target_number = this.data.second.model.meisai[i][param];\r\n\r\n                    result += target_number;\r\n\r\n                }\r\n                return result;\r\n            },\r\n            niukeSearch: function () {\r\n\r\n\r\n                if (this.data.search.dateStart == \"\" || this.data.search.dateEnd == \"\") {\r\n\r\n                    alert(\"日付が入力されていません\");\r\n\r\n                    return false;\r\n                }\r\n                if (new Date(this.data.search.dateStart).getTime() > new Date(this.data.search.dateEnd).getTime()) {\r\n\r\n                    alert(\"日付の関係が逆になっています\");\r\n\r\n                    return false;\r\n                }\r\n\r\n                //検索を更新するときはresultを初期化\r\n                this.data.search.result = [];\r\n\r\n\r\n                var postUrl = url.niukeNyuryokuKensaku + \"?dateKagen=\" + this.data.search.dateStart + \"&dateJyogen=\" + this.data.search.dateEnd + \"&Syorikbn=\" + this.data.first.model.syoriKubun;\r\n\r\n                if (this.data.search.seisansya.code != \"\") {\r\n\r\n                    postUrl += \"&seisansya=\" + this.data.search.seisansya.code;\r\n                } else {\r\n                    postUrl += \"&seisansya=null\";\r\n                }\r\n\r\n\r\n                axios.get(postUrl)\r\n                    .then(response => {\r\n\r\n                        console.log(response.data);\r\n                        for (var i = 0; i < response.data.length; i++) {\r\n\r\n                            var data = response.data[i];\r\n\r\n                            this.addSearchResult(data.date, data.reception_number, data.seisansya, data.syouhin, data.hinsyu, data.frequency, data.total, data.shizai, data.zentokin);\r\n\r\n                        }\r\n\r\n\r\n                    })\r\n                    .catch(response => console.log(response))\r\n\r\n\r\n            },\r\n            //クリックした検索結果を青くする\r\n            searchSelectedTr: function (index) {\r\n\r\n                this.data.search.selectedIndex = index;\r\n            },\r\n            searchResultSelect(search_result) {\r\n\r\n                this.data.receptionNumber = search_result.reception_number;\r\n                //モーダルを閉じる\r\n                this.data.dialogVisible = false;\r\n\r\n\r\n            },\r\n            getSyouhinData: function () {\r\n                //※ここで商品コードを元に商品データを取ってきてdata.syouhin.secondの中に入れる\r\n\r\n            },\r\n            init: function () {\r\n                //初期化\r\n                this.data.second.model.meisai = [];\r\n                this.data.search.result = [];\r\n                this.data.hinsyu = [];\r\n                this.data.second.model.niukeDate = \"\";\r\n                this.data.second.model.seisansyaCode = \"\";\r\n                this.data.second.model.seisansyaName = \"\";\r\n                this.data.syouhin.second.name = \"\";\r\n                this.data.second.model.hinsyuCode = \"\";\r\n                this.data.second.model.hinsyuName = \"\";\r\n                this.data.receptionNumber = \"\";\r\n                this.data.syoriKubun.second = \"0\";\r\n                this.data.total.kayoibako = 0;\r\n                this.data.disabled.niukeConfirm = false;\r\n                this.data.total.number_of_box = 0;\r\n                this.data.total.bara = 0;\r\n                this.data.total.number = 0;\r\n                this.data.shizaidai = 0;\r\n                this.data.zentokin = 0;\r\n\r\n   \r\n            },\r\n            update: function () {\r\n\r\n                this.$refs['secondForm'].validate((valid) => {\r\n\r\n                    if (valid) {\r\n\r\n                        if (this.data.syoriKubun.second == 0 && this.data.first.model.syoriKubun == 1) {\r\n\r\n                            if (this.data.second.model.meisai.length == 0) {\r\n                                alert(\"追加する行がありません\");\r\n                                return false;\r\n                            }\r\n                        }\r\n\r\n                        var message;\r\n                        if (this.data.syoriKubun.second == 0) {\r\n                            message = \"登録しますか？\";\r\n                        } else if (this.data.syoriKubun.second == 1) {\r\n                            message = \"更新しますか？\";\r\n                        } else if (this.data.syoriKubun.second == 2) {\r\n                            message = \"削除しますか？\";\r\n                        }\r\n\r\n                        if (window.confirm(message)) {\r\n\r\n                            var postArray = {\r\n                                \"Reception_number\": 0,\r\n                                \"Seisansyacd\": Number(this.data.second.model.seisansyaCode),\r\n                                \"SyoriKbn\": this.data.first.model.syoriKubun,\r\n                                \"Date\": this.data.second.model.niukeDate,\r\n                                \"Kaisu\": this.$store.state.login.kaisu,\r\n                                \"Syohin\": Number(this.data.syouhin.second.code),\r\n                                \"Hinsyu\": this.data.second.model.hinsyuCode,\r\n                                \"Nyuryokutantocd\": this.$store.state.login.userCode,\r\n                                \"Hakogoukei\": this.data.total.kayoibako,\r\n                                \"ShizaiDai\": this.data.shizaidai,\r\n                                \"MaewatasiKin\": this.data.zentokin,\r\n                                \"Nendo\": Number(this.data.second.model.niukeDate.split(\"-\")[0]),\r\n                                \"JikayoFlg\": 0,\r\n                                \"Data\": [],\r\n                            }\r\n                            if (this.data.first.model.jikayouChecked) {\r\n                                postArray.JikayoFlg = 1\r\n                            } \r\n\r\n\r\n                            if (this.data.first.model.syoriKubun == 9) {\r\n                                postArray.Hinsyu = 0;\r\n                            }\r\n\r\n                            if (this.data.receptionNumber != \"\") {\r\n                                postArray.Reception_number = Number(this.data.receptionNumber);\r\n                            }\r\n\r\n                       \r\n\r\n                            for (var i = 0; i < this.data.second.model.meisai.length; i++) {\r\n\r\n                                var data = this.data.second.model.meisai[i];\r\n\r\n                                if (data.number == \"\") {\r\n                                    data.number = 0;\r\n                                }\r\n\r\n                                postArray.Data.push({\r\n                                    \"Row\": i,\r\n                                    \"Size\": data.size,\r\n                                    \"Tokyu\": data.tokyu,\r\n                                    \"Hako\": data.number_of_box,\r\n                                    \"Bara\": data.bara,\r\n                                    \"Suryo\": data.number,\r\n                                    \"BikouCD\": data.note,\r\n                                    \"HenpinRiyu\": data.reason_of_return,\r\n\r\n                                })\r\n\r\n\r\n\r\n                            }\r\n\r\n                            console.log(postArray);\r\n\r\n                            if (this.data.syoriKubun.second == 0) {\r\n\r\n                                axios.post(url.niukeNyuryoku, postArray)\r\n                                    .then(response => {\r\n\r\n                                        this.$message({\r\n                                            message: '登録に成功しました',\r\n                                            type: 'success'\r\n                                        });\r\n\r\n                                        if (this.data.first.model.syoriKubun == 1) {\r\n\r\n                                            window.open(response.data.url)\r\n\r\n                                        } \r\n\r\n                                        this.init();\r\n                                    })\r\n                                    .catch(response => {\r\n\r\n                                        this.$message({\r\n                                            message: '通信に失敗しました',\r\n                                            type: 'error'\r\n                                        });\r\n                                        console.log(response)\r\n                                    })\r\n\r\n\r\n                            } else if (this.data.syoriKubun.second == 1) {\r\n\r\n                                axios.put(url.niukeNyuryoku, postArray)\r\n                                    .then(response => {\r\n                                       this.$message({\r\n                                            message: '修正に成功しました',\r\n                                            type: 'success'\r\n                                       });\r\n\r\n                                        if (this.data.first.model.syoriKubun == 1) {\r\n\r\n                                            if (window.confirm(\"再印刷しますか？\")) {\r\n                                                window.open(response.data.url)\r\n                                            }\r\n\r\n                                        } \r\n\r\n\r\n                                        this.init();\r\n                                     })\r\n                                    .catch(response => {\r\n\r\n                                        this.$message({\r\n                                            message: '通信に失敗しました',\r\n                                            type: 'error'\r\n                                        });\r\n                                        console.log(response)\r\n                                    })\r\n\r\n                            } else if (this.data.syoriKubun.second == 2) {\r\n\r\n                                postArray = {\r\n                                    \"Reception_number\": this.data.receptionNumber \r\n                                }\r\n\r\n                                axios.delete(url.niukeNyuryoku, { params: postArray })\r\n                                    .then(response => {\r\n                                        \r\n                                       this.$message({\r\n                                            message: '削除に成功しました',\r\n                                            type: 'success'\r\n                                       });\r\n\r\n                                        this.init();\r\n                                     })\r\n                                    .catch(response => {\r\n\r\n                                        this.$message({\r\n                                            message: '通信に失敗しました',\r\n                                            type: 'error'\r\n                                        });\r\n                                        console.log(response)\r\n                                    })\r\n\r\n                            }\r\n\r\n\r\n                        }\r\n\r\n                    }\r\n                });\r\n\r\n            },\r\n            finish: function () {\r\n                this.$router.push('/hoshigaki/');  \r\n            },\r\n            getHinsyuSelect: function () {\r\n\r\n                var getUrl = url.createGetUrl(url.syohinHinsyuTokyuPatternMaster, [{ key: \"paramSyohin\", value: this.data.syouhin.second.code }, { key: \"paramNendo\", value: this.data.second.model.niukeDate.split(\"-\")[0] }]);\r\n                console.log(getUrl);\r\n                axios.get(getUrl)\r\n                    .then(response => {\r\n\r\n                        for (var i = 0; i < response.data.length; i++) {\r\n\r\n                            var data = response.data[i];\r\n\r\n                            var is_exsist = false;\r\n\r\n                            for (var k = 0; k < this.data.hinsyu.length; k++) {\r\n\r\n                                if (data.hinsyuName == this.data.hinsyu[k].hinsyuName) {\r\n                                    is_exsist = true;\r\n                                }\r\n                            }\r\n\r\n                            if (!is_exsist) {\r\n                                this.data.hinsyu.push(data);\r\n                            }\r\n\r\n                        }\r\n                        console.log(response.data);\r\n                    })\r\n                    .catch(response => console.log(response))\r\n\r\n\r\n            },\r\n            getMasterData: function (is_new, meisaiData) {\r\n                //各種必要なマスタデータを取ってくる\r\n\r\n                //※等級を取ってくる\r\n                axios.get(url.syohinSizeTokyuPatternMasterNiuke)\r\n                    .then(response => {\r\n\r\n                        var Data = [];\r\n                        var syouhinCode = this.data.syouhin.second.code;\r\n\r\n                        for (var i = 0; i < response.data.length; i++) {\r\n                            var data = response.data[i];\r\n\r\n                            if (syouhinCode == data.syohinCD) {\r\n\r\n                                Data.push(data);\r\n                            }\r\n\r\n                        }\r\n\r\n\r\n                        var sizeData = [];\r\n                        var tokyuData = [];\r\n\r\n\r\n\r\n                        for (var i = 0; i < Data.length; i++) {\r\n\r\n                            var data = Data[i];\r\n\r\n\r\n                            var is_size_exsist = false;\r\n\r\n                            for (var k = 0; k < sizeData.length; k++) {\r\n\r\n                                if (sizeData[k].size == data.size) {\r\n                                    is_size_exsist = true;\r\n                                }\r\n\r\n                            }\r\n\r\n                            if (!is_size_exsist) {\r\n                                sizeData.push(data);\r\n                            }\r\n\r\n\r\n                            var is_tokyu_exsist = false;\r\n\r\n                            for (var k = 0; k < tokyuData.length; k++) {\r\n                                if (tokyuData[k].tokyu == data.tokyu) {\r\n\r\n                                    is_tokyu_exsist = true;\r\n                                }\r\n\r\n                            }\r\n\r\n                            if (!is_tokyu_exsist) {\r\n                                tokyuData.push(data);\r\n                            }\r\n                        }\r\n\r\n\r\n                        for (var i = 0; i < sizeData.length; i++) {\r\n\r\n                            var size = sizeData[i];\r\n\r\n                            if (Number(size.size) < 10) {\r\n\r\n                                this.data.size[\"0\" + size.size] = size.sizeHyojimei;\r\n\r\n                            } else {\r\n\r\n                                this.data.size[size.size] = size.sizeHyojimei;\r\n\r\n                            }\r\n\r\n                        }\r\n\r\n\r\n                        for (var i = 0; i < tokyuData.length; i++) {\r\n\r\n                            var tokyu = tokyuData[i];\r\n                            if (Number(size.size) < 10) {\r\n\r\n                                this.data.tokyu[\"0\" + tokyu.tokyu] = tokyu.tokyuHyojimei\r\n\r\n                            } else {\r\n\r\n                                this.data.tokyu[tokyu.tokyu] = tokyu.tokyuHyojimei\r\n\r\n                            }\r\n                        }\r\n\r\n\r\n                        console.log(this.data.size, this.data.tokyu);\r\n\r\n\r\n                        var getUrl = url.createGetUrl(url.sizeWaritukeMaster, [{ key: \"paramSyohin\", value: this.data.syouhin.second.code }]);\r\n\r\n\r\n\r\n                        axios.get(getUrl)\r\n                            .then(response => {\r\n                                console.log(\"商品:\", response.data);\r\n                                for (var i = 0; i < response.data.length; i++) {\r\n                                    var data = response.data[i]\r\n                                    this.data.syouhin.second.number_per_box[\"0\" + data.code] = data.irisu\r\n                                }\r\n\r\n\r\n\r\n\r\n\r\n                                axios.get(url.syouhinMaster)\r\n                                    .then(response => {\r\n                                        for (var i in response.data) {\r\n                                            if (this.data.syouhin.second.code == response.data[i].syohinCD) {\r\n\r\n                                                this.data.syouhin.second.niuke_unit = response.data[i].niukeTani;\r\n                                            }\r\n                                        }\r\n\r\n\r\n                                        if (is_new) {\r\n\r\n\r\n                                        } else {\r\n\r\n\r\n                                            for (var i in meisaiData) {\r\n\r\n                                                this.addMeisai(meisaiData[i].code, meisaiData[i].size, meisaiData[i].tokyu, meisaiData[i].number_of_box, meisaiData[i].bara, meisaiData[i].number, meisaiData[i].note, meisaiData[i].henpinRiyu);\r\n\r\n                                            }\r\n\r\n                                        }\r\n\r\n                                        var total_of_box = this.totalCount(\"number_of_box\");\r\n                                        var total_of_bara = this.totalCount(\"bara\");\r\n                                        var total_number = this.totalCount(\"number\");\r\n\r\n                                        this.data.total.number_of_box = total_of_box;\r\n                                        this.data.total.bara = total_of_bara;\r\n                                        this.data.total.number = total_number;\r\n\r\n                                        this.data.disabled.niukeConfirm = true;\r\n\r\n\r\n\r\n                                    })\r\n                                    .catch(response => console.log(response))\r\n\r\n\r\n                            })\r\n                            .catch(response => console.log(response))\r\n\r\n\r\n\r\n\r\n                    })\r\n                    .catch(response => console.log(response))\r\n\r\n\r\n\r\n\r\n\r\n\r\n            },\r\n\r\n        },\r\n        created: function () {\r\n\r\n\r\n            //※返品理由を取ってくる\r\n\r\n            axios.get(url.henpinRiyuMaster)\r\n                .then(response => {\r\n\r\n                    console.log(response.data);\r\n\r\n                    for (var i = 0; i < response.data.length; i++) {\r\n\r\n                        var data = response.data[i];\r\n\r\n                        this.data.reason_of_return[data.key] = data.value;\r\n\r\n                    }\r\n\r\n                    console.log(this.data.reason_of_return);\r\n\r\n                })\r\n                .catch(response => console.log(response))\r\n\r\n\r\n            //※備考を取ってくる\r\n\r\n\r\n            axios.get(url.bikouMaster)\r\n                .then(response => {\r\n\r\n                    console.log(response.data);\r\n\r\n                    for (var i = 0; i < response.data.length; i++) {\r\n\r\n                        var data = response.data[i];\r\n\r\n                        this.data.note[data.key] = data.value;\r\n                    }\r\n\r\n                    console.log(this.data.note);\r\n\r\n                })\r\n                .catch(response => console.log(response))\r\n\r\n\r\n        },\r\n        mounted: function () {\r\n\r\n            //※荷受け日付(システム日付)\r\n            this.data.first.model.niukeDate = time.nowJapanDateInput();\r\n\r\n            //※端末番号\r\n            this.data.numberOfTerminal = this.$store.state.login.userCode;\r\n\r\n            //※荷受回数\r\n            this.data.first.model.kaisu = this.$store.state.login.kaisu;\r\n\r\n            this.data.search.dateStart = time.nowJapanDateInput();\r\n\r\n            this.data.search.dateEnd = time.nowJapanDateInput();\r\n\r\n        },\r\n        watch: {\r\n            'data.first.model.syoriKubun': function () {\r\n\r\n\r\n                if (this.data.first.model.syoriKubun == 9) {\r\n\r\n                    for (var i in this.data.checked) {\r\n                        this.data.first.model.jikayouChecked = false;\r\n                        this.data.first.model.niukeHyouChecked = false;\r\n                        this.data.first.model.niukeHyouHikaeChecked = false;\r\n\r\n                    }\r\n                    this.data.first.validation.syouhinCode[0].required = false;\r\n\r\n\r\n                } else {\r\n                    this.data.first.validation.syouhinCode[0].required = true;\r\n                }\r\n\r\n            },\r\n\r\n\r\n            \"data.syoriKubun.second\": function (new_value) {\r\n\r\n                if (new_value == 0) {\r\n\r\n                    this.data.receptionNumber = \"\";\r\n                    this.data.disabled.receptionNumber = true;\r\n                    this.data.disabled.receptionNumberSearch = true;\r\n\r\n\r\n                } else if (new_value == 1 || new_value == 2) {\r\n\r\n                    this.data.disabled.receptionNumber = false;\r\n                    this.data.disabled.receptionNumberSearch = false;\r\n\r\n                }\r\n            },\r\n\r\n\r\n        }\r\n\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .search-selected {\r\n        background-color: blue;\r\n        color: white;\r\n    }\r\n    .bold-border-bottom {\r\n        border-bottom: solid 2px #000000;\r\n    }\r\n\r\n    th {\r\n        font-size: 1.1rem !important;\r\n        font-weight: bold !important;\r\n        color: black !important;\r\n    }\r\n</style>"]}]}